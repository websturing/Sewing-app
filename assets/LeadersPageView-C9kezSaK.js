import{d as V,k as w,c as y,x as M,e as a,t as b,g as o,W as Q,L as X,w as x,o as g,l as E,m as B,f as h,E as C,D as Y,p as H,y as O,a as e,n as I,F as R,H as T,v as Z,s as ee,r as W}from"./index-DB4A7y2x.js";import{_ as D}from"./BaseButton.vue_vue_type_script_setup_true_lang-Bp8bVCQe.js";import{A as te}from"./AlertOutline-doPgZAEZ.js";import{u as se}from"./useFieldWrapper-_1VWAyfI.js";import{o as N,c as ae,a as F,n as z,s as _}from"./types-CVZIcfwR.js";import{A as P}from"./api.schema-B7NsqcGR.js";import{c as ne}from"./defect.summaryApi-CUJMEH2X.js";import{u as le}from"./line.page-D_OnFDKQ.js";import{u as oe}from"./user.table-DBIwsgQY.js";import{t as re}from"./vee-validate-zod-BbSQ0Xk-.js";import{u as ie}from"./vee-validate-CvQk7bTx.js";import{S as de}from"./SaveArrowRight20Filled-CrY1V4u2.js";import{_ as ue}from"./BaseInput.vue_vue_type_script_setup_true_lang-Ra6cEyMw.js";import{S as me}from"./SearchOutline-CbKIUZzU.js";import{R as ce}from"./RefreshRound-C5pOx1-8.js";import{C as G}from"./ChartPerson20Filled-CofOX65u.js";import{F as pe}from"./FolderDetailsReference-6Ru8RMDg.js";import{S as fe}from"./SmartHome-HF0rl-uP.js";import"./index-B-cYlh1f.js";import"./_commonjsHelpers-CE1G-McA.js";import"./stockin.api.schema-DC3-uBMr.js";import"./metaPagination-9MSE0uSw.js";import"./dateRangeFormaterNaive-ClR-GZjc.js";import"./user.store-L2QK93Wz.js";import"./user.schema-BXMI3HnA.js";import"./employeeSchema-AqYtwcrb.js";const ge={class:"flex flex-col gap-1"},ve=["status","for"],j=V({__name:"BaseSelectWithError",props:{modelValue:{},options:{},placeholder:{default:"Select option"},clearable:{type:Boolean,default:!0},filterable:{type:Boolean,default:!0},size:{default:"medium"},icon:{default:null},errors:{},label:{},name:{},multiple:{type:Boolean,default:!1},classContent:{}},emits:["update:modelValue"],setup(n,{emit:t}){const s=n,c=t,r=w(()=>s.errors?.[s.name]),p=w(()=>r.value?"error":void 0);return(u,i)=>{const d=h("n-icon"),v=h("n-tooltip");return g(),y("div",ge,[u.label?(g(),y("label",{key:0,status:p.value,for:s.name,class:"text-sm font-medium text-gray-700"},b(u.label),9,ve)):M("",!0),a(o(Q),{id:s.name,value:s.modelValue,options:s.options,multiple:s.multiple,placeholder:s.placeholder,clearable:s.clearable,filterable:s.filterable,size:s.size,"onUpdate:value":i[0]||(i[0]=m=>c("update:modelValue",m)),class:X([s.classContent,"!min-w-[200px]"]),"max-tag-count":s.multiple?0:void 0,"render-tag":s.multiple?()=>null:void 0},{arrow:x(()=>[r.value?(g(),E(v,{key:0,show:!!r.value,trigger:"hover"},{trigger:x(()=>[a(d,{component:o(te),color:"red"},null,8,["component"])]),default:x(()=>[B(" "+b(r.value),1)]),_:1},8,["show"])):M("",!0)]),_:1},8,["id","value","options","multiple","placeholder","clearable","filterable","size","class","max-tag-count","render-tag"])])}}}),_e=N({userId:z().nullable().refine(n=>n!==null,"Leader is required").transform(n=>n),lineId:F(z()).min(1,"Leader is required"),isActive:ae()}),U="/api",ye={getAssignments:()=>C.get(`${U}/leaders`).then(n=>n.data),createAssign:n=>C.post(`${U}/leaders/assign`,n).then(t=>t.data),createUnassign:n=>C.post(`${U}/leaders/unassign`,n).then(t=>t.data)},q=N({assignAt:_(),unassignAt:_().nullable(),lineId:z().nullable(),lineName:_().nullable(),createdBy:_(),updatedBy:_().nullable(),lastUpdated:_()}),be=N({leader:_(),activeLines:_(),lastUpdated:_().nullable(),activeDetail:F(q),inactiveDetail:F(q)}),he=ne(F(be)),J=Y("leaderStore",{state:()=>({loading:!1,error:null,AssignmentSummaryByLeader:[]}),actions:{async fetchSummaryByLeader(){this.loading=!0,this.error=null;try{const n=await ye.getAssignments(),t=he.parse(n);return this.AssignmentSummaryByLeader=t.data,P.parse({success:!0,message:t.message??"loaded"})}catch(n){const t=n?.response?.data?.message||"Something went wrong";return this.error=t,P.parse({success:!1,message:t})}finally{this.loading=!1}}}});function Le(n=null){H(),J();const{rows:t,handleFetch:s}=oe(),{data:c,handleFetch:r}=le(),p=w(()=>t.value.map(L=>({label:L.name,value:L.id}))),u=w(()=>c.value.map(L=>({label:L.name,value:L.id}))),i=async()=>{await Promise.all([s(),r({notify:!1},{})])},d=()=>({userId:n?.userId??null,lineId:n?.lineId??[],isActive:n?.isActive??!0}),{handleSubmit:v,errors:m,isSubmitting:A,resetForm:l,validate:S}=ie({validationSchema:re(_e),initialValues:d()}),{userId:k,lineId:f,isActive:$}=se(["userId","lineId","isActive"]);return{userId:k,lineId:f,isActive:$,optionUsers:p,optionLines:u,handleUserLineData:i,onSubmit:v,resetForm:()=>{l({values:d(),errors:{}})},errors:m,isSubmitting:A,validateForm:async()=>{const L=await S();return L.valid?{valid:!0,values:L.values}:{valid:!1}}}}const xe={class:"flex flex-col gap-5"},Se={class:"flex gap-2 items-end"},Ae={class:"flex flex-col"},we={class:"bg-gray-50 border border-gray-200 p-3 rounded-lg"},Be={class:"flex gap-2 flex-wrap mt-2"},Fe={class:"flex gap-2 justify-end"},Ve=V({__name:"LeaderAssignmentForm",setup(n){const{userId:t,lineId:s,isActive:c,optionLines:r,optionUsers:p,onSubmit:u,errors:i,resetForm:d,handleUserLineData:v}=Le(),m=u(A=>{alert()});return O(async()=>{await v()}),(A,l)=>{const S=h("n-switch"),k=h("n-tag");return g(),y("div",null,[e("form",{onSubmit:l[3]||(l[3]=Z((...f)=>o(m)&&o(m)(...f),["prevent"]))},[e("div",xe,[l[6]||(l[6]=e("div",{class:"mb-5"},[e("p",{class:"text-xl font-semibold"},"Leader Assignment Form"),e("p",null,"A dedicated form interface for assigning leaders to specific production lines.")],-1)),e("div",Se,[a(j,{name:"userId",options:o(p),label:"Leaders",modelValue:o(t),"onUpdate:modelValue":l[0]||(l[0]=f=>I(t)?t.value=f:null),placeholder:"Select Leader",errors:o(i)},null,8,["options","modelValue","errors"]),a(j,{name:"lineId",options:o(r),multiple:"",label:"Lines",modelValue:o(s),"onUpdate:modelValue":l[1]||(l[1]=f=>I(s)?s.value=f:null),placeholder:"Select Lines",errors:o(i)},null,8,["options","modelValue","errors"]),e("div",Ae,[l[4]||(l[4]=e("label",{id:"isActive",class:"mb-2 font-semibold"},"Is Active",-1)),a(S,{round:!1,size:"large",value:o(c),"onUpdate:value":l[2]||(l[2]=f=>I(c)?c.value=f:null)},null,8,["value"])])]),e("div",we,[l[5]||(l[5]=e("p",{class:"text-xs text-gray-400"},"Selected Lines",-1)),e("div",Be,[(g(!0),y(R,null,T(o(s),f=>(g(),E(k,{key:f,size:"small",type:"info",round:""},{default:x(()=>[B(b(o(r).find($=>$.value===f)?.label),1)]),_:2},1024))),128))])]),e("div",Fe,[a(D,{label:"Reset",onClick:o(d),type:"error",quaternary:""},null,8,["onClick"]),a(D,{label:"Assign Leader",icon:o(de),"icon-placement":"right",type:"primary",attrType:"submit"},null,8,["icon"])])])],32)])}}});function K(){const n=H(),t=J(),{loading:s,AssignmentSummaryByLeader:c}=ee(t);return{isLoading:s,AssignmentSummaryByLeader:c,fetchSummaryByLeader:async(p={notify:!0})=>{const{success:u,message:i}=await t.fetchSummaryByLeader();return p.notify&&(u?n.success(i):n.error(i)),{success:u,message:i}}}}const ke={class:"flex flex-col gap-5"},$e={class:"flex justify-between"},Ce={class:"!w-[300px]"},Ie={class:"flex gap-3 items-center"},Ue=V({__name:"SummaryLeaderTable",setup(n){const t=W(""),s=w(()=>{const i=t.value.toLowerCase().trim();return i?(r.value||[]).filter(d=>d.leader?.toLowerCase().includes(i)||d.activeLines?.toLowerCase().includes(i)):r.value||[]}),{isLoading:c,AssignmentSummaryByLeader:r,fetchSummaryByLeader:p}=K(),u=async()=>{await p()};return(i,d)=>{const v=D,m=h("n-skeleton"),A=h("n-table");return g(),y("div",ke,[e("div",$e,[e("div",Ce,[a(ue,{icon:o(me),placeholder:"Search",modelValue:t.value,"onUpdate:modelValue":d[0]||(d[0]=l=>t.value=l)},null,8,["icon","modelValue"])]),e("div",Ie,[a(v,{label:"Refresh",icon:o(ce),onClick:u},null,8,["icon"]),a(v,{label:"Create Leader Assignment",icon:o(G),onClick:u,type:"primary"},null,8,["icon"])])]),a(A,null,{default:x(()=>[d[2]||(d[2]=e("thead",null,[e("tr",null,[e("th",null,"No"),e("th",null,"Leader"),e("th",null,"Line Assignments"),e("th",null,"Last Updated"),e("th",null,"Status")])],-1)),e("tbody",null,[o(c)?(g(),y(R,{key:0},T(10,l=>e("tr",{key:l},[e("td",null,[a(m,{text:""})]),e("td",null,[a(m,{text:""})]),e("td",null,[a(m,{text:""})]),e("td",null,[a(m,{text:""})]),e("td",null,[a(m,{text:""})]),e("td",null,[a(m,{text:""})]),e("td",null,[a(m,{text:""})]),e("td",null,[a(m,{text:""})])])),64)):(g(!0),y(R,{key:1},T(s.value,(l,S)=>(g(),y("tr",{key:S},[e("td",null,b(S+1),1),e("td",null,b(l.leader),1),e("td",null,b(l.activeLines),1),e("td",null,b(l.lastUpdated),1),e("td",null,[a(v,{label:"Detail",icon:o(pe),onClick:d[1]||(d[1]=()=>{}),tertiary:""},null,8,["icon"])])]))),128))])]),_:1})])}}}),Re={class:"flex flex-col gap-10"},Te={class:"flex justify-between items-center"},De={class:"w-84 flex-auto"},ze={class:"text-xl font-bold mb-1"},Ne={class:"w-16 flex-auto text-right"},pt=V({__name:"LeadersPageView",setup(n){const t=W({title:"Leader Management Module",description:"A centralized interface enabling users to view, create, and maintain leader records assigned across multiple production lines. The module streamlines oversight, improves data governance, and ensures operational visibility by providing a structured workflow for leader placement and line assignments."}),{fetchSummaryByLeader:s}=K();return O(async()=>{await s()}),(c,r)=>{const p=h("n-icon"),u=h("n-breadcrumb-item"),i=h("n-breadcrumb");return g(),y("div",Re,[e("div",Te,[e("div",De,[e("h2",ze,b(t.value.title),1),e("p",null,b(t.value.description),1)]),e("div",Ne,[a(i,null,{default:x(()=>[a(u,null,{default:x(()=>[a(p,{component:o(fe)},null,8,["component"]),r[0]||(r[0]=B(" Home",-1))]),_:1}),a(u,null,{default:x(()=>[a(p,{component:o(G)},null,8,["component"]),r[1]||(r[1]=B(" Leaders ",-1))]),_:1})]),_:1})])]),a(Ue),a(Ve)])}}});export{pt as default};
