import{E as c,D as S}from"./index-BkxyZoiH.js";import{q as f}from"./index-B-cYlh1f.js";import{M as u,L as g,A as i}from"./api.schema-BwRGpLBP.js";import{o as n,s as e,n as t,a as o,c as m,e as w,u as G}from"./types-D48y91Ee.js";const Q=n({id:t().optional(),glNumber:e().min(1,"Line name is required"),createdAt:e().optional(),updatedAt:e().optional()}),b=o(Q),C=n({message:e(),data:b,links:g,meta:u,status:m()}),N=n({glNo:e(),totalBundle:t(),totalPcs:t(),totalColors:t(),totalSizes:t(),lastUpdated:e(),lineNames:e()}),J=n({status:m(),message:e(),data:o(N),links:g,meta:u}),d=n({orderQty:t().int().nonnegative(),cutQty:t().int().nonnegative()}),h=n({size:e(),orderQty:t().int().nonnegative(),cutQty:t().int().nonnegative()}),k=n({id:t().optional(),color:e(),type:e(),summary:d,sizeBreakdown:o(h)}),v=n({orderQty:t().int().nonnegative(),cutQty:t().int().nonnegative()}),A=n({size:e(),orderQty:t().int().nonnegative(),cutQty:t().int().nonnegative()}),B=n({glNumber:e(),layingPlannings:o(k),glSummary:v,glSizeBreakdown:o(A)}),z=n({color:e(),type:w(["BODY","COMBINASI"]),summary:d,sizeBreakdown:o(h)}),R=n({orderQty:t().int().nonnegative(),cutQty:t().int().nonnegative()}),D=n({glNumbers:o(e())}),L=n({totalGlCount:t().int().positive(),totalColorCount:t().int().positive(),totalLayingPlannings:t().int().positive(),generatedAt:e(),lastUpdated:e(),filtersApplied:D}),P=n({message:e(),status:t(),data:n({summaryByGl:o(B),summaryByColor:o(z),grandTotal:R,metadata:L})}),T="/api",x={getMatrix:s=>c.get(`${T}/gls/matrix-date`,{params:s,paramsSerializer:r=>f.stringify(r,{arrayFormat:"brackets"})}).then(r=>r.data)},I=n({glNo:e(),date:e(),size:e(),totalBundle:t(),totalPcs:G([e(),t()]),lineNames:e(),totalColors:t()}),y=n({size:e(),totalPcs:t(),totalBundle:t()}),M=n({color:e(),totalPcs:t(),totalBundle:t(),totalSizes:t(),sizes:o(y)}),O=n({glNo:e(),sizes:o(y),colors:o(M)}),F=n({status:m(),message:e(),glNo:e(),hasRecentData:m(),startDate:e(),endDate:e(),count:t(),data:o(I),summary:O}),q=n({id:t(),cuttingGlColorId:t(),size:e(),orderQty:t(),cutQty:t(),stockOutQty:t(),replacementQty:t(),createdAt:e(),updatedAt:e(),sewingStockinQty:t(),sewingStockoutQty:t()}),U=n({id:t(),cuttingGlSummaryId:t(),color:e(),type:e(),orderQty:t(),cutQty:t(),stockOutQty:t(),replacementQty:t(),lastSyncAt:e(),createdAt:e(),updatedAt:e(),sewingTotalStockinQty:t(),sewingTotalStockoutQty:t(),sizes:o(q)}),p=n({id:t(),glNumber:e(),orderQty:t(),cutQty:t(),stockOutQty:t(),replacementQty:t(),lastSyncAt:e(),sewingTotalStockinQty:t(),sewingTotalStockoutQty:t(),colors:o(U)}),$=n({status:m(),message:e(),data:p});p.omit({colors:!0});const K=S("gls",{state:()=>({data:[],searchResult:[],isSearching:!1,meta:{},links:{},loading:!1,error:null,currentPage:1,lastPage:1,search:"",summaryGl:[],summaryByColor:[],total:{},metaSummary:{},matrixData:[],matrixSummary:{}}),actions:{async fetch(s={}){this.loading=!0,this.error=null;try{const r={page:s.page??1,perPage:s.perPage??50,q:s.q??void 0,dateFrom:s.dateFrom,dateTo:s.dateTo};s.q&&(this.searchResult=[],this.isSearching=!0);const a=await c.get("/api/gls",{params:r}),l=C.parse(a.data);return this.meta=l.meta,this.links=l.links,this.currentPage=l.meta.currentPage,this.lastPage=l.meta.lastPage,s.q?this.searchResult=l.data:(this.data=l.data,this.isSearching=!1,this.searchResult=[]),i.parse({success:!0,message:l.message??"Gl Numbers loaded"})}catch(r){const a=r?.response?.data?.message||"Something went wrong";return this.error=a,i.parse({success:!1,message:a})}finally{this.loading=!1}},async fetchGLNumber(s){this.loading=!0,this.error=null;try{const a=(await c.get(`/api/gls/number/${s}`)).data;return i.parse({success:!0,message:a.message??"Gl Numbers loaded",id:a.data.id})}catch(r){const a=r?.response?.data?.message||"Something went wrong";return this.error=a,i.parse({success:!1,message:a})}finally{this.loading=!1}},async fetchSummaryGl(s){this.loading=!0,this.error=null;try{const r=await c.get("/api/gls/cutting-summary",{params:{glNumber:s}}),a=P.parse(r.data);return this.summaryGl=a.data.summaryByGl,this.summaryByColor=a.data.summaryByColor,this.metaSummary=a.data.metadata,this.total=a.data.grandTotal,i.parse({success:!0,message:r.data.message??"Gl Numbers loaded"})}catch(r){const a=r?.response?.data?.message||"Something went wrong";return this.error=a,i.parse({success:!1,message:a})}finally{this.loading=!1}},async fetchSyncCuttingGL(s){this.loading=!0,this.error=null;try{const r=await c.get("/api/gls/syncCuttingGlNumber",{params:{glNumber:s}}),a=$.parse(r.data);return console.log(a),i.parse({success:!0,message:r.data.message??"Gl Numbers loaded"})}catch(r){const a=r?.response?.data?.message||"Something went wrong";return this.error=a,i.parse({success:!1,message:a})}finally{this.loading=!1}},async fetchGLMatix(s){this.loading=!0,this.error=null;try{const r=await x.getMatrix(s),a=F.parse(r);return this.matrixData=a.data,this.matrixSummary=a.summary,i.parse({success:!0,message:a.message??"Summary Chart loaded",data:{startDate:a.startDate,endDate:a.endDate,glNo:a.glNo,summary:a.summary,chartData:a.data}})}catch(r){const a=r?.response?.data?.message||"Something went wrong";return this.error=a,i.parse({success:!1,message:a})}finally{this.loading=!1}},async searchOrFetch(s){if(this.search!==s&&(this.searchResult=[],this.isSearching=!1),this.search=s,!s)return await this.fetch(),this.data;const r=this.data.filter(l=>l.glNumber?.toLowerCase().includes(s));return r.length>0?(this.searchResult=r,this.isSearching=!0,r):(await this.fetch({page:1,q:s})).success?this.searchResult:[]}},getters:{searchedItems:s=>{if(!s.search)return s.data;if(s.isSearching&&s.searchResult.length)return s.searchResult;const r=s.search.toLowerCase();return s.data.filter(a=>a.glNumber?.toLowerCase().includes(r))},options(){return this.searchedItems.map(s=>({value:s.glNumber||"",label:s.glNumber||""}))}}});export{J as G,$ as a,K as u};
