import{_ as T}from"./BaseButton.vue_vue_type_script_setup_true_lang-6COBzGJa.js";import{_ as V}from"./BaseInput.vue_vue_type_script_setup_true_lang-s-FVRIev.js";import{E as N,D as M,p as A,s as U,d as C,r as S,k as q,c as u,a as e,e as o,g as h,f as b,w as v,o as i,F as g,H as x,t as c,y as z}from"./index-BnOAq3x5.js";import{d as E,a as H,b as O}from"./defect.summaryApi-CUJMEH2X.js";import{A as y}from"./api.schema-B7NsqcGR.js";import{S as I}from"./SearchOutline-ZZWidM_-.js";import{R as J}from"./RefreshRound-CKHk1D1F.js";import{R as K,F as Q}from"./Repeat-DRy4kbSQ.js";import"./types-CVZIcfwR.js";const D="/api",k={getSummaryGroupLines:()=>N.get(`${D}/defect/summary/lines`).then(l=>l.data),getGroupLines:()=>N.get(`${D}/defect`).then(l=>l.data),getGroupGlNumber:()=>N.get(`${D}/defect/group/gl-number`).then(l=>l.data)},W=M("defect",{state:()=>({loading:!1,error:null,defectData:[],defectGroupLines:[],defectGroupGlNumber:[],summaryGroupLine:{}}),actions:{async fetchSummaryGroupLines(){this.loading=!0,this.error=null;try{const l=await k.getSummaryGroupLines(),s=O.parse(l);return this.summaryGroupLine=s.data,y.parse({success:!0,message:s.message??"loaded"})}catch(l){const s=l?.response?.data?.message||"Something went wrong";return this.error=s,y.parse({success:!1,message:s})}finally{this.loading=!1}},async fetchGroupLines(){this.loading=!0,this.error=null;try{const l=await k.getGroupLines(),s=H.parse(l);return this.defectGroupLines=s.data,y.parse({success:!0,message:s.message??"loaded"})}catch(l){const s=l?.response?.data?.message||"Something went wrong";return this.error=s,y.parse({success:!1,message:s})}finally{this.loading=!1}},async fetchGroupGlNumber(){this.loading=!0,this.error=null;try{const l=await k.getGroupGlNumber(),s=E.parse(l);return this.defectGroupGlNumber=s.data,y.parse({success:!0,message:s.message??"loaded"})}catch(l){const s=l?.response?.data?.message||"Something went wrong";return this.error=s,y.parse({success:!1,message:s})}finally{this.loading=!1}}}});function R(){const l=A(),s=W(),{loading:n,summaryGroupLine:_,defectGroupLines:d,defectGroupGlNumber:m}=U(s);return{loading:n,summaryGroupLine:_,defectGroupLines:d,defectGroupGlNumber:m,handleFetchGroupGlNumber:async(p={notify:!0})=>{const{success:r,message:t}=await s.fetchGroupGlNumber();return p.notify&&(r?l.success(t):l.error(t)),{success:r,message:t}},handleFetchSummaryGroupLines:async(p={notify:!0})=>{const{success:r,message:t}=await s.fetchSummaryGroupLines();return p.notify&&(r?l.success(t):l.error(t)),{success:r,message:t}},handleFetchGroupLines:async(p={notify:!0})=>{const{success:r,message:t}=await s.fetchGroupLines();return p.notify&&(r?l.success(t):l.error(t)),{success:r,message:t}}}}const X={class:"flex flex-col gap-3"},Y={class:"flex justify-between"},Z={class:"!w-[300px]"},ee={class:"flex gap-2"},te={class:"text-center"},se={class:"!bg-red-100 text-center"},le={class:"text-center"},oe={class:"text-center"},ae=["colspan"],ne={class:"!text-center !bg-white"},re={class:"!text-center"},ce={class:"!text-center"},ue={class:"!text-center !text-red-400"},ie={class:"!text-center"},de={class:"!bg-gray-50 !text-center !font-semibold"},me={class:"!bg-gray-50 !text-center"},pe=C({__name:"DefectGroupGlNumberTable",setup(l){const s=S(""),n=S(),_=S(!1),{loading:d,defectGroupGlNumber:m,handleFetchGroupGlNumber:w}=R(),F=q(()=>{const r=s.value.toLowerCase().trim();return r?(m.value||[]).filter(t=>t.glNumber?.toLowerCase().includes(r)||t.color?.toLowerCase().includes(r)||t.lineNames?.toLowerCase().includes(r)):m.value||[]}),L=async()=>{await w()},p=r=>{_.value=!0,n.value=m.value[r]};return(r,t)=>{const G=T,f=b("n-skeleton"),P=b("n-table"),j=b("n-modal");return i(),u("div",X,[e("div",Y,[e("div",Z,[o(V,{icon:h(I),placeholder:"Search",modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=a=>s.value=a)},null,8,["icon","modelValue"])]),e("div",ee,[o(G,{label:"Refresh",icon:h(J),onClick:L},null,8,["icon"]),o(G,{label:"Create Request Replacement",icon:h(K),onClick:L,type:"primary"},null,8,["icon"])])]),o(P,null,{default:v(()=>[t[2]||(t[2]=e("thead",null,[e("tr",null,[e("th",{class:"!w-[20px]"},"No"),e("th",{class:"!w-[80px]"},"GL Number"),e("th",null,"Color"),e("th",{class:"!w-[30px]"},"Cut Pieces"),e("th",{class:"!w-[30px] !bg-red-100"},"Defects"),e("th",{class:"!w-[30px]"},"Balance"),e("th",{class:"!w-[200px] !text-center"},"Line"),e("th",{class:"!w-[80px]"},"Status")])],-1)),e("tbody",null,[h(d)?(i(),u(g,{key:0},x(10,a=>e("tr",{key:a},[e("td",null,[o(f,{text:""})]),e("td",null,[o(f,{text:""})]),e("td",null,[o(f,{text:""})]),e("td",null,[o(f,{text:""})]),e("td",null,[o(f,{text:""})]),e("td",null,[o(f,{text:""})]),e("td",null,[o(f,{text:""})]),e("td",null,[o(f,{text:""})])])),64)):(i(!0),u(g,{key:1},x(F.value,(a,$)=>(i(),u("tr",{key:a.glNumber},[e("td",null,c($+1),1),e("td",null,c(a.glNumber),1),e("td",null,[o(G,{label:a.color,onClick:B=>p($),quaternary:"",type:"primary"},null,8,["label","onClick"])]),e("td",te,c(a.totalPcs),1),e("td",se,c(a.totalDefect),1),e("td",le,c(a.totalPcs-a.totalDefect),1),e("td",oe,c(a.lineNames),1),e("td",null,[o(G,{label:"Detail",icon:h(Q),onClick:B=>p($),tertiary:""},null,8,["icon","onClick"])])]))),128))])]),_:1}),o(j,{show:_.value,"onUpdate:show":t[1]||(t[1]=a=>_.value=a),preset:"card",style:"width: 1200px",title:`GL-${n.value?.glNumber.toString()} | ${n.value?.lineNames}`},{default:v(()=>[o(P,null,{default:v(()=>[e("thead",null,[e("tr",null,[t[3]||(t[3]=e("th",{class:"!bg-white"},"Color",-1)),e("th",{colspan:(n.value?.items.length??0)+1,class:"!text-center !bg-white !text-blue-600 !font-semibold"},c(n.value?.color),9,ae)]),e("tr",null,[t[4]||(t[4]=e("th",{class:"!bg-white"},"Size",-1)),(i(!0),u(g,null,x(n.value?.items,a=>(i(),u("th",ne,c(a.size),1))),256)),t[5]||(t[5]=e("th",{class:"!bg-white !text-center"},"Total",-1))])]),e("tbody",null,[e("tr",null,[t[6]||(t[6]=e("td",null,"Cut Piece",-1)),(i(!0),u(g,null,x(n.value?.items,a=>(i(),u("td",re,c(a.totalPcs),1))),256)),e("td",ce,c(n.value?.totalPcs),1)]),e("tr",null,[t[7]||(t[7]=e("td",null,"Defect",-1)),(i(!0),u(g,null,x(n.value?.items,a=>(i(),u("td",ue,c(a.totalDefect),1))),256)),e("td",ie,c(n.value?.totalDefect),1)]),e("tr",null,[t[8]||(t[8]=e("td",{class:"!bg-gray-50"},"Balance",-1)),(i(!0),u(g,null,x(n.value?.items,a=>(i(),u("td",de,c(a.totalPcs-a.totalDefect),1))),256)),e("td",me,c((n.value?.totalPcs??0)-(n.value?.totalDefect??0)),1)])])]),_:1})]),_:1},8,["show","title"])])}}}),fe={class:"!w-[300px]"},he={key:0,class:"flex flex-col gap-1"},_e={class:"flex gap-2 items-end justify-between"},ge={class:"text-gray-400"},xe={class:"text-lg font-bold text-red-600"},ye={class:"text-sm"},be={class:"flex justify-between"},we={class:"text-gray-400"},Ge={class:"font-semibold"},ve={class:"flex justify-between"},Le={class:"text-gray-400 text-xs"},$e={class:"text-gray-400 text-xs"},Ne={key:1,class:"flex flex-col gap-1"},Se={class:"flex gap-2 items-end justify-between"},De={class:"text-lg font-bold text-red-600"},ke={class:"text-sm"},Ce={class:"flex justify-between"},Re={class:"font-semibold"},Fe=C({__name:"DefectSummaryCard",setup(l){const{loading:s,summaryGroupLine:n}=R();return(_,d)=>{const m=b("n-skeleton"),w=b("n-card");return i(),u("div",fe,[o(w,{class:"shadow-xs"},{default:v(()=>[h(s)?(i(),u("div",he,[e("div",_e,[e("p",ge,[o(m,{width:80,text:""})]),e("p",xe,[o(m,{width:40,text:""})])]),e("div",ye,[e("div",be,[e("p",we,[o(m,{width:80,text:""})]),e("p",Ge,[o(m,{width:20,text:""})])])]),d[0]||(d[0]=e("div",{class:"border-b-1 border-gray-200 my-2"},null,-1)),e("div",ve,[e("p",Le,[o(m,{width:80,text:""})]),e("p",$e,[o(m,{width:120,text:""})])])])):(i(),u("div",Ne,[e("div",Se,[d[1]||(d[1]=e("p",{class:"text-gray-400"},"Total Defect",-1)),e("p",De,c(h(n).totalDefect),1)]),e("div",ke,[e("div",Ce,[d[2]||(d[2]=e("p",{class:"text-gray-400"},"Total Lines",-1)),e("p",Re,c(h(n).totalLines),1)])]),d[3]||(d[3]=e("div",{class:"border-b-1 border-gray-200 my-2"},null,-1)),d[4]||(d[4]=e("div",{class:"flex justify-between"},[e("p",{class:"text-gray-400 text-xs"},"Last Updated"),e("p",{class:"text-gray-400 text-xs"},"November 20, 2025 12:10")],-1))]))]),_:1})])}}}),Pe={class:"flex flex-col gap-10"},Ee=C({__name:"DefectPageView",setup(l){const{handleFetchSummaryGroupLines:s,handleFetchGroupGlNumber:n}=R();return z(async()=>{await s(),await n()}),(_,d)=>(i(),u("div",Pe,[o(Fe),o(pe)]))}});export{Ee as default};
