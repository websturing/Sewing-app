import{D as pe,E as G,p as de,s as ce,r as me,y as ye,q as ge,d as ve,c as ie,o as re,a as L,x as $e,e as R,g as D,n as N,f as te,L as we,w as ne,m as Me,t as Se,l as be,M as De,v as Ee,h as Ce}from"./index-ByIyiulO.js";import{t as xe,I as se}from"./vee-validate-zod-CHTSAnC3.js";import{S as _e}from"./SaveAnnotation-DKcUubUV.js";import{Q as ke}from"./QrCode20Filled-Cs1uKHRf.js";import{A as V}from"./metaPagination-BtrCOo_7.js";import{E as Le,a as Oe,b as je}from"./employeeSchema-BKc-Bb2P.js";import{u as Fe}from"./useFieldWrapper-O2BqaZNP.js";import{g as Te}from"./_commonjsHelpers-CE1G-McA.js";import{u as Ve}from"./vee-validate-BC2kabU5.js";var ae={exports:{}},Ye=ae.exports,le;function Re(){return le||(le=1,(function(a,o){(function(u,d){a.exports=d()})(Ye,(function(){var u=1e3,d=6e4,O=36e5,C="millisecond",S="second",E="minute",w="hour",g="day",j="week",v="month",F="quarter",x="year",T="date",B="Invalid Date",W=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,J={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(n){var s=["th","st","nd","rd"],e=n%100;return"["+n+(s[(e-20)%10]||s[e]||s[0])+"]"}},A=function(n,s,e){var r=String(n);return!r||r.length>=s?n:""+Array(s+1-r.length).join(e)+n},Z={s:A,z:function(n){var s=-n.utcOffset(),e=Math.abs(s),r=Math.floor(e/60),t=e%60;return(s<=0?"+":"-")+A(r,2,"0")+":"+A(t,2,"0")},m:function n(s,e){if(s.date()<e.date())return-n(e,s);var r=12*(e.year()-s.year())+(e.month()-s.month()),t=s.clone().add(r,v),i=e-t<0,l=s.clone().add(r+(i?-1:1),v);return+(-(r+(e-t)/(i?t-l:l-t))||0)},a:function(n){return n<0?Math.ceil(n)||0:Math.floor(n)},p:function(n){return{M:v,y:x,w:j,d:g,D:T,h:w,m:E,s:S,ms:C,Q:F}[n]||String(n||"").toLowerCase().replace(/s$/,"")},u:function(n){return n===void 0}},Y="en",h={};h[Y]=J;var K="$isDayjsObject",_=function(n){return n instanceof X||!(!n||!n[K])},I=function n(s,e,r){var t;if(!s)return Y;if(typeof s=="string"){var i=s.toLowerCase();h[i]&&(t=i),e&&(h[i]=e,t=i);var l=s.split("-");if(!t&&l.length>1)return n(l[0])}else{var f=s.name;h[f]=s,t=f}return!r&&t&&(Y=t),t||!r&&Y},p=function(n,s){if(_(n))return n.clone();var e=typeof s=="object"?s:{};return e.date=n,e.args=arguments,new X(e)},c=Z;c.l=I,c.i=_,c.w=function(n,s){return p(n,{locale:s.$L,utc:s.$u,x:s.$x,$offset:s.$offset})};var X=(function(){function n(e){this.$L=I(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[K]=!0}var s=n.prototype;return s.parse=function(e){this.$d=(function(r){var t=r.date,i=r.utc;if(t===null)return new Date(NaN);if(c.u(t))return new Date;if(t instanceof Date)return new Date(t);if(typeof t=="string"&&!/Z$/i.test(t)){var l=t.match(W);if(l){var f=l[2]-1||0,y=(l[7]||"0").substring(0,3);return i?new Date(Date.UTC(l[1],f,l[3]||1,l[4]||0,l[5]||0,l[6]||0,y)):new Date(l[1],f,l[3]||1,l[4]||0,l[5]||0,l[6]||0,y)}}return new Date(t)})(e),this.init()},s.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},s.$utils=function(){return c},s.isValid=function(){return this.$d.toString()!==B},s.isSame=function(e,r){var t=p(e);return this.startOf(r)<=t&&t<=this.endOf(r)},s.isAfter=function(e,r){return p(e)<this.startOf(r)},s.isBefore=function(e,r){return this.endOf(r)<p(e)},s.$g=function(e,r,t){return c.u(e)?this[r]:this.set(t,e)},s.unix=function(){return Math.floor(this.valueOf()/1e3)},s.valueOf=function(){return this.$d.getTime()},s.startOf=function(e,r){var t=this,i=!!c.u(r)||r,l=c.p(e),f=function(H,b){var P=c.w(t.$u?Date.UTC(t.$y,b,H):new Date(t.$y,b,H),t);return i?P:P.endOf(g)},y=function(H,b){return c.w(t.toDate()[H].apply(t.toDate("s"),(i?[0,0,0,0]:[23,59,59,999]).slice(b)),t)},$=this.$W,M=this.$M,k=this.$D,z="set"+(this.$u?"UTC":"");switch(l){case x:return i?f(1,0):f(31,11);case v:return i?f(1,M):f(0,M+1);case j:var U=this.$locale().weekStart||0,q=($<U?$+7:$)-U;return f(i?k-q:k+(6-q),M);case g:case T:return y(z+"Hours",0);case w:return y(z+"Minutes",1);case E:return y(z+"Seconds",2);case S:return y(z+"Milliseconds",3);default:return this.clone()}},s.endOf=function(e){return this.startOf(e,!1)},s.$set=function(e,r){var t,i=c.p(e),l="set"+(this.$u?"UTC":""),f=(t={},t[g]=l+"Date",t[T]=l+"Date",t[v]=l+"Month",t[x]=l+"FullYear",t[w]=l+"Hours",t[E]=l+"Minutes",t[S]=l+"Seconds",t[C]=l+"Milliseconds",t)[i],y=i===g?this.$D+(r-this.$W):r;if(i===v||i===x){var $=this.clone().set(T,1);$.$d[f](y),$.init(),this.$d=$.set(T,Math.min(this.$D,$.daysInMonth())).$d}else f&&this.$d[f](y);return this.init(),this},s.set=function(e,r){return this.clone().$set(e,r)},s.get=function(e){return this[c.p(e)]()},s.add=function(e,r){var t,i=this;e=Number(e);var l=c.p(r),f=function(M){var k=p(i);return c.w(k.date(k.date()+Math.round(M*e)),i)};if(l===v)return this.set(v,this.$M+e);if(l===x)return this.set(x,this.$y+e);if(l===g)return f(1);if(l===j)return f(7);var y=(t={},t[E]=d,t[w]=O,t[S]=u,t)[l]||1,$=this.$d.getTime()+e*y;return c.w($,this)},s.subtract=function(e,r){return this.add(-1*e,r)},s.format=function(e){var r=this,t=this.$locale();if(!this.isValid())return t.invalidDate||B;var i=e||"YYYY-MM-DDTHH:mm:ssZ",l=c.z(this),f=this.$H,y=this.$m,$=this.$M,M=t.weekdays,k=t.months,z=t.meridiem,U=function(b,P,Q,ee){return b&&(b[P]||b(r,i))||Q[P].slice(0,ee)},q=function(b){return c.s(f%12||12,b,"0")},H=z||function(b,P,Q){var ee=b<12?"AM":"PM";return Q?ee.toLowerCase():ee};return i.replace(m,(function(b,P){return P||(function(Q){switch(Q){case"YY":return String(r.$y).slice(-2);case"YYYY":return c.s(r.$y,4,"0");case"M":return $+1;case"MM":return c.s($+1,2,"0");case"MMM":return U(t.monthsShort,$,k,3);case"MMMM":return U(k,$);case"D":return r.$D;case"DD":return c.s(r.$D,2,"0");case"d":return String(r.$W);case"dd":return U(t.weekdaysMin,r.$W,M,2);case"ddd":return U(t.weekdaysShort,r.$W,M,3);case"dddd":return M[r.$W];case"H":return String(f);case"HH":return c.s(f,2,"0");case"h":return q(1);case"hh":return q(2);case"a":return H(f,y,!0);case"A":return H(f,y,!1);case"m":return String(y);case"mm":return c.s(y,2,"0");case"s":return String(r.$s);case"ss":return c.s(r.$s,2,"0");case"SSS":return c.s(r.$ms,3,"0");case"Z":return l}return null})(b)||l.replace(":","")}))},s.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},s.diff=function(e,r,t){var i,l=this,f=c.p(r),y=p(e),$=(y.utcOffset()-this.utcOffset())*d,M=this-y,k=function(){return c.m(l,y)};switch(f){case x:i=k()/12;break;case v:i=k();break;case F:i=k()/3;break;case j:i=(M-$)/6048e5;break;case g:i=(M-$)/864e5;break;case w:i=M/O;break;case E:i=M/d;break;case S:i=M/u;break;default:i=M}return t?i:c.a(i)},s.daysInMonth=function(){return this.endOf(v).$D},s.$locale=function(){return h[this.$L]},s.locale=function(e,r){if(!e)return this.$L;var t=this.clone(),i=I(e,r,!0);return i&&(t.$L=i),t},s.clone=function(){return c.w(this.$d,this)},s.toDate=function(){return new Date(this.valueOf())},s.toJSON=function(){return this.isValid()?this.toISOString():null},s.toISOString=function(){return this.$d.toISOString()},s.toString=function(){return this.$d.toUTCString()},n})(),oe=X.prototype;return p.prototype=oe,[["$ms",C],["$s",S],["$m",E],["$H",w],["$W",g],["$M",v],["$y",x],["$D",T]].forEach((function(n){oe[n[1]]=function(s){return this.$g(s,n[0],n[1])}})),p.extend=function(n,s){return n.$i||(n(s,X,p),n.$i=!0),p},p.locale=I,p.isDayjs=_,p.unix=function(n){return p(1e3*n)},p.en=h[Y],p.Ls=h,p.p={},p}))})(ae)),ae.exports}var Be=Re();const ue=Te(Be),fe=pe("employee",{state:()=>({data:[],searchResult:[],isSearching:!1,meta:{},links:{},loading:!1,error:null,currentPage:1,lastPage:1,search:"",employeeLastCode:""}),actions:{async fetchEmployee(a={}){this.loading=!0,this.error=null;try{const o={page:a.page??1,perPage:a.perPage??10,q:a.q??void 0,dateFrom:a.dateFrom,dateTo:a.dateTo};a.q&&(this.searchResult=[],this.isSearching=!0);const u=await G.get("/api/employee",{params:o}),d=Oe.parse(u.data);return this.meta=d.meta,this.links=d.links,this.currentPage=d.meta.currentPage,this.lastPage=d.meta.lastPage,a.q?this.searchResult=d.data:(this.data=d.data,this.isSearching=!1,this.searchResult=[]),V.parse({success:!0,message:d.message??"Employees loaded"})}catch(o){const u=o?.response?.data?.message||"Something went wrong";return this.error=u,V.parse({success:!1,message:u})}finally{this.loading=!1}},async searchOrFetch(a){if(this.search!==a&&(this.searchResult=[],this.isSearching=!1),this.search=a,!a)return await this.fetchEmployee(),this.data;const o=this.data.filter(d=>d.employeeCode?.toLowerCase().includes(a)||d.department?.toLowerCase().includes(a)||d.position?.toLowerCase().includes(a));return o.length>0?(this.searchResult=o,this.isSearching=!0,o):(await this.fetchEmployee({page:1,q:a})).success?this.searchResult:[]},async fetchEmployeeLastCode(){this.loading=!0,this.error=null;try{const a=await G.get("/api/employee/code"),o=Le.parse(a.data);return this.employeeLastCode=o.data,V.parse({success:!0,message:o.message??"Employees loaded"})}catch(a){const o=a?.response?.data?.message||"Something went wrong";return this.error=o,V.parse({success:!1,message:o})}finally{this.loading=!1}},async createEmployee(a){this.loading=!0,this.error=null;try{const o=await G.post("/api/employee",a);return this.data.push(o.data.data),this.error=null,V.parse({success:!0,message:o.data.message??"Employees loaded",id:o.data.data.id})}catch(o){const u=o?.response?.data?.message||"Terjadi kesalahan";return this.error=u,V.parse({success:!1,message:u})}finally{this.loading=!1}},async updateEmployee(a,o){this.loading=!0,this.error=null;try{const u=await G.post(`/api/employee/${a}`,o),d=this.data.findIndex(O=>O.id===a);return d!==-1&&(this.data[d]={...this.data[d],...u.data.data}),this.error=null,V.parse({success:!0,message:u.data.message??"Employee Update Successfully"})}catch(u){const d=u?.response?.data?.message||"Terjadi kesalahan";return this.error=d,V.parse({success:!1,message:d})}finally{this.loading=!1}},async deleteEmployee(a){this.loading=!0,this.error=null;try{const o=await G.delete(`/api/employee/${a}`);return this.data=this.data.filter(u=>u.id!==a),this.error=null,V.parse({success:!0,message:o.data.message??"Employees loaded"})}catch(o){const u=o?.response?.data?.message||"Terjadi kesalahan";return this.error=u,V.parse({success:!1,message:u})}finally{this.loading=!1}}},getters:{searchedItems:a=>{if(!a.search)return a.data;if(a.isSearching&&a.searchResult.length)return a.searchResult;const o=a.search.toLowerCase();return a.data.filter(u=>u.employeeCode?.toLowerCase().includes(o)||u.department?.toLowerCase().includes(o)||u.position?.toLowerCase().includes(o))}}});function he(a=null){const o=de(),u=fe(),{data:d}=ce(u),O=me(ue().subtract(17,"year").format("YYYY-MM-DD")),C=()=>({employeeCode:a?.employeeCode??"",name:a?.name??"",gender:a?.gender??"male",dateBirth:a?.dateBirth??O.value,joinDate:a?.joinDate??ue().format("YYYY-MM-DD"),position:a?.position??"",department:a?.department??"",active:a?.active??!0,id:a?.id,userId:a?.userId,device_id:a?.device_id,createdAt:a?.createdAt}),{handleSubmit:S,errors:E,isSubmitting:w,resetForm:g,validate:j}=Ve({validationSchema:xe(je),initialValues:C()}),v=()=>{g({values:C(),errors:{}})},{employeeCode:F,position:x,department:T,active:B,name:W,gender:m,dateBirth:J,joinDate:A}=Fe(["employeeCode","name","gender","dateBirth","joinDate","position","department","active"]),Z=async()=>{const _=await j();return _.valid?{valid:!0,values:_.values}:{valid:!1}},Y=S(_=>_),h=async(_,I)=>{const{success:p,message:c}=await u.updateEmployee(_,I);p?o.success(c):o.error(c)},K=async _=>{const{success:I,message:p}=await u.deleteEmployee(_);I?o.success(p):o.error(p)};return ye(async()=>{a?.employeeCode||(await u.fetchEmployeeLastCode(),F.value=u.employeeLastCode)}),ge(()=>a,()=>v(),{deep:!0,immediate:!0}),{employeeCode:F,name:W,gender:m,dateBirth:J,joinDate:A,position:x,department:T,active:B,onSubmit:S,resetForm:v,updateEmployee:h,deleteEmployee:K,data:d,errors:E,isSubmitting:w,validateForm:Z,submitForm:Y}}const Ae={class:"flex flex-col gap-3"},Ie={class:"flex gap-2"},Pe={class:"w-30"},Ue={class:"w-40"},He={class:"flex gap-2"},Xe=ve({__name:"EmployeeForm",props:{initialData:{},submitLabel:{default:"Create Employee"},submitType:{default:"default"},placmentEnd:{type:Boolean,default:!1},visible:{type:Boolean,default:!0},icon:{default:_e}},emits:["click:submitted"],setup(a,{expose:o,emit:u}){const d=a,O=u,{employeeCode:C,name:S,gender:E,dateBirth:w,joinDate:g,position:j,department:v,errors:F,validateForm:x,onSubmit:T}=he(d.initialData),B=T(W=>{O("click:submitted",W)});return o({name:S,validateForm:x,submit:B}),(W,m)=>{const J=te("n-select"),A=te("n-date-picker"),Z=te("n-icon"),Y=te("n-button");return re(),ie("div",null,[L("form",{onSubmit:m[7]||(m[7]=Ee((...h)=>D(B)&&D(B)(...h),["prevent"]))},[L("div",Ae,[L("div",null,[R(se,{icon:D(ke),modelValue:D(C),"onUpdate:modelValue":m[0]||(m[0]=h=>N(C)?C.value=h:null),name:"employeeCode",errors:D(F),readonly:!0,label:"Employee Code",classContent:"!bg-gray-100 !w-45"},null,8,["icon","modelValue","errors"])]),L("div",Ie,[R(se,{modelValue:D(S),"onUpdate:modelValue":m[1]||(m[1]=h=>N(S)?S.value=h:null),name:"name",errors:D(F),label:"Employee Name",placeholder:"Please type name",class:"w-200"},null,8,["modelValue","errors"]),L("div",Pe,[m[8]||(m[8]=L("label",{for:"gender",class:"text-sm font-medium text-gray-700"}," Gender ",-1)),R(J,{style:{"margin-top":"3px"},id:"gender",size:"medium",value:D(E),"onUpdate:value":m[2]||(m[2]=h=>N(E)?E.value=h:null),options:[{value:"male",label:"Male"},{value:"female",label:"Female"}]},null,8,["value"])]),L("div",Ue,[m[9]||(m[9]=L("label",{for:"dateBirth",class:"text-sm font-medium text-gray-700"}," Date Birth ",-1)),R(A,{id:"dateBirth",style:{"margin-top":"3px"},"formatted-value":D(w),"onUpdate:formattedValue":m[3]||(m[3]=h=>N(w)?w.value=h:null),"value-format":"yyyy-MM-dd",type:"date"},null,8,["formatted-value"])])]),L("div",He,[L("div",null,[m[10]||(m[10]=L("label",{for:"joinDate",class:"text-sm font-medium text-gray-700"}," Join Date ",-1)),R(A,{id:"joinDate",style:{"margin-top":"3px"},"formatted-value":D(g),"onUpdate:formattedValue":m[4]||(m[4]=h=>N(g)?g.value=h:null),"value-format":"yyyy-MM-dd",type:"date"},null,8,["formatted-value"])]),R(se,{modelValue:D(j),"onUpdate:modelValue":m[5]||(m[5]=h=>N(j)?j.value=h:null),name:"position",errors:D(F),label:"Position",placeholder:"Please type position employee"},null,8,["modelValue","errors"]),R(se,{modelValue:D(v),"onUpdate:modelValue":m[6]||(m[6]=h=>N(v)?v.value=h:null),name:"department",errors:D(F),label:"Department",placeholder:"Please type department employee"},null,8,["modelValue","errors"])]),d.visible?(re(),ie("div",{key:0,class:we([d.placmentEnd?"justify-end":"","flex gap-2 mt-10"])},[L("div",null,[R(Y,{type:d.submitType,"icon-placement":"right","attr-type":"submit",block:""},{icon:ne(()=>[R(Z,null,{default:ne(()=>[(re(),be(De(d.icon)))]),_:1})]),default:ne(()=>[Me(" "+Se(d.submitLabel),1)]),_:1},8,["type"])])],2)):$e("",!0)])],32)])}}});function et(){const a=me({title:"Employees",description:"The Employee module provides a centralized space to manage workforce data, including personal information, job details, and access rights. It enables administrators to add, update, and organize employee records efficiently while ensuring accurate and secure handling of sensitive information."}),o=fe(),u=de(),d=Ce(),{data:O}=ce(o),{resetForm:C}=he();return{meta:a,data:O,handleFetchEmployee:async()=>{const{success:w,message:g}=await o.fetchEmployee();w||u.error(g)},handleCreateEmployee:async w=>{const{message:g}=await o.createEmployee(w);u.success(g),C(),d.push({name:"employee"})}}}export{Xe as _,et as a,he as b,fe as u};
