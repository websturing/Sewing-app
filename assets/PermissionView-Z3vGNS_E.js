import{u as B,_ as ee}from"./RoleForm.vue_vue_type_script_setup_true_lang-CbAOZw-3.js";import{p as W,s as H,r as R,k as J,q as te,d as T,c as U,o as N,a as i,v as ne,g as t,e as n,n as S,f as a,w as o,m as M,x as oe,t as O,y as K,i as E,z as le,A as ae,B as G,C as se}from"./index-DKBTRk-l.js";import{I as j}from"./InputLabelWithError-BArHEzIi.js";import{c as ie,a as q}from"./index.esm-CMgMSMaE.js";import{u as re,a as D}from"./vee-validate-emIdRdtZ.js";import{S as ue}from"./SendOutline-9SPwDLId.js";import{u as de}from"./useRoleTable-Dw_tbht4.js";import{u as me}from"./Role-C2UxYGZJ.js";import{S as Q}from"./SearchOutline-BmJKTtXS.js";import{R as X,C as Y}from"./ReloadOutline-DM6vWb7I.js";import{C as pe,T as ce}from"./Trash-DkM1KI5p.js";import"./types-CVZIcfwR.js";import"./vee-validate-zod-BO4IYhAf.js";import"./EyeOutline-B4cxGYh5.js";import"./AlertOutline-ChyIBSBw.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./_commonjsHelpers-CE1G-McA.js";const fe=ie({name:q().required(),slug:q().required(),icon:q().required()}),I=R(!1);function L(f=null){const v=B(),l=W(),{data:r}=H(v),_=R(f?.parentId||null),b=J(()=>r.value.map(w=>({label:w.name,value:w.id}))),{handleSubmit:x,errors:g,isSubmitting:k,resetForm:d}=re({validationSchema:fe,initialValues:{name:f?.name||"",slug:f?.slug||"",icon:f?.icon||"",order:f?.order||1,isActive:f?.isActive||!0}}),{value:u}=D("name"),{value:h}=D("slug"),{value:P}=D("icon"),{value:V}=D("order"),{value:s}=D("isActive"),m=R(f?.parentId!=null),e=R(!!f?.id);console.log("edit data",e.value);const p=()=>{d({values:{name:"",slug:"",icon:"",isActive:!0},errors:{}}),_.value=null,m.value=!1},$=x(async w=>{try{const C={name:w.name,slug:w.slug,icon:w.icon,order:w.order,isActive:w.isActive,parentId:_.value};if(e.value)try{const z=await v.updateModule(f.id,C);l.success(z),I.value=!1,p()}catch(z){l.error(z||"Gagal menyimpan data")}else try{const z=await v.createModule(C);l.success(z),I.value=!1,p()}catch(z){l.error(z||"Gagal menyimpan data")}}catch(C){console.error("Error submitting form:",C)}});return te(m,()=>{m.value||(_.value=null)},{immediate:!0}),{isModal:I,name:u,slug:h,icon:P,order:V,isActive:s,parentId:_,isParent:m,isEdit:e,onSubmit:$,resetForm:p,parentData:r,parentOptions:b,errors:g,isSubmitting:k}}const ve={class:"p-4"},_e={class:"flex gap-2 mb-4 mt-5 items-center"},ge={class:"flex-grow-1"},be={class:"flex items-center gap-2 mb-4"},ye={key:0,class:"flex-1"},Z=T({__name:"PermissionForm",props:{initialData:{}},setup(f){const v=f,{name:l,slug:r,icon:_,order:b,isActive:x,isParent:g,parentId:k,parentOptions:d,errors:u,onSubmit:h,isEdit:P,resetForm:V}=L(v.initialData),s=({focused:m,checked:e})=>{const p={};return e?(p.background="#18a058",m&&(p.boxShadow="0 0 0 2px #d0305040")):(p.background="#d03050",m&&(p.boxShadow="0 0 0 2px #2080f040")),p};return(m,e)=>{const p=a("n-input-number"),$=a("n-switch"),w=a("n-select"),C=a("n-button"),z=a("n-icon"),A=a("n-space");return N(),U("div",ve,[i("form",{onSubmit:e[7]||(e[7]=ne((...c)=>t(h)&&t(h)(...c),["prevent"]))},[n(j,{modelValue:t(l),"onUpdate:modelValue":e[0]||(e[0]=c=>S(l)?l.value=c:null),name:"name",errors:t(u),label:"Module Name"},null,8,["modelValue","errors"]),i("div",_e,[n(j,{modelValue:t(r),"onUpdate:modelValue":e[1]||(e[1]=c=>S(r)?r.value=c:null),name:"slug",errors:t(u),label:"Slug Name"},null,8,["modelValue","errors"]),n(j,{modelValue:t(_),"onUpdate:modelValue":e[2]||(e[2]=c=>S(_)?_.value=c:null),name:"slug",errors:t(u),label:"Icon"},null,8,["modelValue","errors"]),i("div",null,[e[8]||(e[8]=i("label",{for:"order"},"order",-1)),n(p,{id:"order",status:t(u).order?"error":"",value:t(b),"onUpdate:value":e[3]||(e[3]=c=>S(b)?b.value=c:null)},null,8,["status","value"])]),i("div",ge,[e[11]||(e[11]=i("p",null,"Â ",-1)),n($,{id:"is_active",value:t(x),"onUpdate:value":e[4]||(e[4]=c=>S(x)?x.value=c:null),"rail-style":s},{checked:o(()=>[...e[9]||(e[9]=[M(" Active ",-1)])]),unchecked:o(()=>[...e[10]||(e[10]=[M(" inactive ",-1)])]),_:1},8,["value"])])]),i("div",be,[i("div",null,[e[14]||(e[14]=i("p",null,"Parent Menu",-1)),n($,{value:t(g),"onUpdate:value":e[5]||(e[5]=c=>S(g)?g.value=c:null)},{checked:o(()=>[...e[12]||(e[12]=[M(" Select Parent ",-1)])]),unchecked:o(()=>[...e[13]||(e[13]=[M(' Has Parent?" ',-1)])]),_:1},8,["value"])]),t(g)?(N(),U("div",ye,[e[15]||(e[15]=i("label",null,"Select Parent",-1)),n(w,{size:"medium",value:t(k),"onUpdate:value":e[6]||(e[6]=c=>S(k)?k.value=c:null),options:t(d),optionValue:"id",placeholder:"Select parent module"},null,8,["value","options"])])):oe("",!0)]),n(A,{class:"mt-10",justify:"end"},{default:o(()=>[n(C,{block:"",onClick:t(V)},{default:o(()=>[...e[16]||(e[16]=[M(" reset ",-1)])]),_:1},8,["onClick"]),n(C,{type:"success","icon-placement":"right","attr-type":"submit",block:""},{icon:o(()=>[n(z,null,{default:o(()=>[n(t(ue))]),_:1})]),default:o(()=>[M(" "+O(t(P)?"Apply Changes":"Create New"),1)]),_:1})]),_:1})],32)])}}}),we={class:"flex justify-between"},Se={class:"flex justify-end mt-4"},ke={class:"text-gray-400"},xe=T({__name:"RoleTable",emits:["edit","create"],setup(f,{emit:v}){const l=R({}),r=v,_=me(),{data:b,filteredData:x,searchRef:g,loading:k,page:d,pageSize:u,pageSizes:h,columns:P,fnRefresh:V}=de({onEdit:m=>r("edit",m)}),{isModal:s}=L();return K(()=>{_.fetchRole()}),(m,e)=>{const p=a("n-icon"),$=a("n-input"),w=a("n-button"),C=a("n-space"),z=a("n-data-table"),A=a("n-pagination"),c=a("n-card"),F=a("n-modal");return N(),U("div",null,[n(C,{vertical:"",size:"large"},{default:o(()=>[i("div",we,[i("div",null,[n($,{placeholder:"Search",value:t(g),"onUpdate:value":e[0]||(e[0]=y=>S(g)?g.value=y:null),clearable:""},{prefix:o(()=>[n(p,{component:t(Q)},null,8,["component"])]),_:1},8,["value"])]),i("div",null,[n(C,null,{default:o(()=>[n(w,{type:"warning",block:"",onClick:t(V)},{icon:o(()=>[n(p,null,{default:o(()=>[n(t(X))]),_:1})]),default:o(()=>[e[5]||(e[5]=M(" Refresh ",-1))]),_:1},8,["onClick"]),n(w,{type:"success",block:"",onClick:e[1]||(e[1]=y=>m.$emit("create"))},{icon:o(()=>[n(p,null,{default:o(()=>[n(t(Y))]),_:1})]),default:o(()=>[e[6]||(e[6]=M(" Create Role ",-1))]),_:1})]),_:1})])]),n(z,{columns:t(P),data:t(x).slice((t(d)-1)*t(u),t(d)*t(u)),bordered:"",loading:t(k),"single-line":!1},null,8,["columns","data","loading"]),i("div",Se,[n(A,{page:t(d),"onUpdate:page":e[2]||(e[2]=y=>S(d)?d.value=y:null),"page-size":t(u),"onUpdate:pageSize":e[3]||(e[3]=y=>S(u)?u.value=y:null),"item-count":t(b).length,"page-sizes":t(h),"show-size-picker":"","show-quick-jumper":""},{prefix:o(()=>[i("span",ke,"Total: "+O(t(b).length)+" items",1)]),_:1},8,["page","page-size","item-count","page-sizes"])])]),_:1}),n(F,{show:t(s),"onUpdate:show":e[4]||(e[4]=y=>S(s)?s.value=y:null)},{default:o(()=>[n(c,{style:{width:"900px"},title:"Modal",bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{default:o(()=>[n(Z,{initialData:l.value},null,8,["initialData"])]),_:1})]),_:1},8,["show"])])}}}),Ce=T({__name:"RoleView",setup(f){const v=R(null),l=R(!1),r=R("New Role"),_=k=>{r.value="Edit Role",v.value=k,l.value=!0},b=()=>{r.value="Create Role",l.value=!0},x=()=>{r.value="Create Role",l.value=!1},g=()=>{v.value=null};return(k,d)=>{const u=a("n-modal");return N(),U("div",null,[n(xe,{onEdit:_,onCreate:b}),n(u,{show:l.value,"onUpdate:show":d[0]||(d[0]=h=>l.value=h),"on-after-leave":g,closable:!0,title:r.value,preset:"card",style:{width:"900px"}},{default:o(()=>[n(ee,{onSubmitted:x,initialData:v.value},null,8,["initialData"])]),_:1},8,["show","title"])])}}});function ze(f){const v=B(),l=W(),{data:r,loading:_}=H(v),b=R(""),x=J(()=>b.value?r.value.filter(s=>s.name.toLowerCase().includes(b.value.toLowerCase())):r.value),g=R(1),k=R(5),d=[5,10,20,50],u=[{title:"No",key:"index",render:(s,m)=>m+1},{title:"Name",key:"name"},{title:"Slug",key:"slug"},{title:"Actions",key:"actions",render:s=>E(le,{justify:"center"},{default:()=>[E(ae,{placement:"top"},{trigger:()=>E(G,{size:"small",quaternary:!0,onClick:()=>h(s)},{default:()=>"Edit",icon:()=>E(pe)}),default:()=>"Edit data"}),E(se,{onPositiveClick:()=>P(s),negativeText:"Cancel",positiveText:"Delete",positiveButtonProps:{type:"error",size:"small",ghost:!0},negativeButtonProps:{type:"default",size:"small"}},{trigger:()=>E(G,{size:"small",type:"error",quaternary:!1},{default:()=>"Delete",icon:()=>E(ce)}),default:()=>"Are you sure you want to proceed?"})]})}];function h(s){f?.onEdit?f.onEdit(s):console.log("Edit row:",s)}async function P(s){const m=await v.deleteModule(s.id);l.info(m)}return{data:r,loading:_,columns:u,searchRef:b,page:g,pageSize:k,pageSizes:d,filteredData:x,fnRefresh:()=>{v.fetchModule()}}}const Re={class:"flex justify-between"},he={class:"flex justify-end mt-4"},Me={class:"text-gray-400"},Pe=T({__name:"PermissionTable",setup(f){const v=R("Permission Form"),l=R({}),r=m=>{console.log(m),l.value=m,s.value=!0},_=B(),{data:b,filteredData:x,searchRef:g,loading:k,page:d,pageSize:u,pageSizes:h,columns:P,fnRefresh:V}=ze({onEdit:r}),{isModal:s}=L();return K(()=>{_.fetchModule()}),(m,e)=>{const p=a("n-icon"),$=a("n-input"),w=a("n-button"),C=a("n-space"),z=a("n-data-table"),A=a("n-pagination"),c=a("n-card"),F=a("n-modal");return N(),U("div",null,[n(C,{vertical:"",size:"large"},{default:o(()=>[i("div",Re,[i("div",null,[n($,{placeholder:"Search",value:t(g),"onUpdate:value":e[0]||(e[0]=y=>S(g)?g.value=y:null),clearable:""},{prefix:o(()=>[n(p,{component:t(Q)},null,8,["component"])]),_:1},8,["value"])]),i("div",null,[n(C,null,{default:o(()=>[n(w,{type:"warning",block:"",onClick:t(V)},{icon:o(()=>[n(p,null,{default:o(()=>[n(t(X))]),_:1})]),default:o(()=>[e[5]||(e[5]=M(" Refresh ",-1))]),_:1},8,["onClick"]),n(w,{type:"success",block:"",onClick:e[1]||(e[1]=y=>s.value=!0)},{icon:o(()=>[n(p,null,{default:o(()=>[n(t(Y))]),_:1})]),default:o(()=>[e[6]||(e[6]=M(" Create Permission ",-1))]),_:1})]),_:1})])]),n(z,{columns:t(P),data:t(x).slice((t(d)-1)*t(u),t(d)*t(u)),bordered:"",loading:t(k),"single-line":!1},null,8,["columns","data","loading"]),i("div",he,[n(A,{page:t(d),"onUpdate:page":e[2]||(e[2]=y=>S(d)?d.value=y:null),"page-size":t(u),"onUpdate:pageSize":e[3]||(e[3]=y=>S(u)?u.value=y:null),"item-count":t(b).length,"page-sizes":t(h),"show-size-picker":"","show-quick-jumper":""},{prefix:o(()=>[i("span",Me,"Total: "+O(t(b).length)+" items",1)]),_:1},8,["page","page-size","item-count","page-sizes"])])]),_:1}),n(F,{show:t(s),"onUpdate:show":e[4]||(e[4]=y=>S(s)?s.value=y:null)},{default:o(()=>[n(c,{style:{width:"900px"},title:v.value,bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{default:o(()=>[n(Z,{initialData:l.value},null,8,["initialData"])]),_:1},8,["title"])]),_:1},8,["show"])])}}}),Ve={class:"mt-5"},Je=T({__name:"PermissionView",setup(f){return(v,l)=>{const r=a("n-tab-pane"),_=a("n-tabs");return N(),U("div",null,[l[0]||(l[0]=i("h2",{class:"text-xl font-bold mb-1"},"Access Control",-1)),l[1]||(l[1]=i("p",null,"Manage menu and feature permissions for user roles. or Configure what users can see and do based on their role",-1)),i("div",Ve,[n(_,{type:"segment",animated:"","default-value":"role"},{default:o(()=>[n(r,{name:"role",tab:"Roles"},{default:o(()=>[n(Ce)]),_:1}),n(r,{name:"menu",tab:"Menu Permission"},{default:o(()=>[n(Pe)]),_:1})]),_:1})])])}}});export{Je as default};
