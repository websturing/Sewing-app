import{D as c,E as i}from"./index-DB4A7y2x.js";import{A as r}from"./api.schema-B7NsqcGR.js";import{a as l}from"./user.schema-BXMI3HnA.js";const d=c("users",{state:()=>({data:[],searchResult:[],isSearching:!1,meta:{},links:{},loading:!1,error:null,currentPage:1,lastPage:1,search:""}),actions:{async fetch(e={}){this.loading=!0,this.error=null;try{const s={page:e.page??1,perPage:e.perPage??10,q:e.q??void 0,dateFrom:e.dateFrom,dateTo:e.dateTo};e.q&&(this.searchResult=[],this.isSearching=!0);const a=await i.get("/api/users",{params:s}),t=l.parse(a.data);return this.meta=t.meta,this.links=t.links,this.currentPage=t.meta.currentPage,this.lastPage=t.meta.lastPage,e.q?this.searchResult=t.data:(this.data=t.data,this.isSearching=!1,this.searchResult=[]),r.parse({success:!0,message:t.message??"Employees loaded"})}catch(s){const a=s?.response?.data?.message||"Something went wrong";return this.error=a,r.parse({success:!1,message:a})}finally{this.loading=!1}},async searchOrFetch(e){if(this.search!==e&&(this.searchResult=[],this.isSearching=!1),this.search=e,!e)return await this.fetch(),this.data;const s=this.data.filter(t=>t.name?.toLowerCase().includes(e)||t.email?.toLowerCase().includes(e));return s.length>0?(this.searchResult=s,this.isSearching=!0,s):(await this.fetch({page:1,q:e})).success?this.searchResult:[]},async create(e){this.loading=!0,this.error=null;try{const s=await i.post("/api/users",e);return this.data.push(s.data.data),this.error=null,r.parse({success:!0,message:s.data.message??"Data Created Succesfully",id:s.data.data.id})}catch(s){const a=s?.response?.data?.message||"Someting Wrong";return this.error=a,r.parse({success:!1,message:a})}finally{this.loading=!1}},async update(e,s){this.loading=!0,this.error=null;try{const a=await i.post(`/api/users/${e}`,s),t=this.data.findIndex(n=>n.id===e);return t!==-1&&(this.data[t]={...this.data[t],...a.data.data}),this.error=null,r.parse({success:!0,message:a.data.message??"Data Update Successfully"})}catch(a){const t=a?.response?.data?.message||"Something Wrong";return this.error=t,r.parse({success:!1,message:t})}finally{this.loading=!1}},async delete(e){this.loading=!0,this.error=null;try{const s=await i.delete(`/api/users/${e}`);return this.data=this.data.filter(a=>a.id!==e),this.error=null,r.parse({success:!0,message:s.data.message??"Data Delete Successfully"})}catch(s){const a=s?.response?.data?.message||"Something Wrong";return this.error=a,r.parse({success:!1,message:a})}finally{this.loading=!1}}},getters:{searchedItems:e=>{if(!e.search)return e.data;if(e.isSearching&&e.searchResult.length)return e.searchResult;const s=e.search.toLowerCase();return e.data.filter(a=>a.name?.toLowerCase().includes(s)||a.email?.toLowerCase().includes(s))}}});export{d as u};
