import{E as c,D as b}from"./index-KKLjXh5o.js";import{q as u}from"./index-B-cYlh1f.js";import{M as y,L as p}from"./metaPagination-BMwnZfrC.js";import{o as n,s as a,n as t,a as o,c as m,f as Q,u as g}from"./types-CVZIcfwR.js";import{A as i}from"./api.schema-B7NsqcGR.js";const N=n({id:t().optional(),glNumber:a().min(1,"Line name is required"),createdAt:a().optional(),updatedAt:a().optional()}),C=o(N),L=n({message:a(),data:C,links:p,meta:y,status:m()}),k=n({glNo:a(),totalBundle:t(),totalPcs:t(),totalColors:t(),totalSizes:t(),lastUpdated:a(),lineNames:a()}),J=n({status:m(),message:a(),data:o(k),links:p,meta:y}),S=n({orderQty:t().int().nonnegative(),cutQty:t().int().nonnegative()}),f=n({size:a(),orderQty:t().int().nonnegative(),cutQty:t().int().nonnegative()}),v=n({id:t().optional(),color:a(),type:a(),summary:S,sizeBreakdown:o(f)}),z=n({orderQty:t().int().nonnegative(),cutQty:t().int().nonnegative()}),A=n({size:a(),orderQty:t().int().nonnegative(),cutQty:t().int().nonnegative()}),B=n({glNumber:a(),layingPlannings:o(v),glSummary:z,glSizeBreakdown:o(A)}),D=n({color:a(),type:Q(["BODY","COMBINASI"]),summary:S,sizeBreakdown:o(f)}),R=n({orderQty:t().int().nonnegative(),cutQty:t().int().nonnegative()}),P=n({glNumbers:o(a())}),T=n({totalGlCount:t().int().positive(),totalColorCount:t().int().positive(),totalLayingPlannings:t().int().positive(),generatedAt:a(),lastUpdated:a(),filtersApplied:P}),x=n({summaryByGl:o(B),summaryByColor:o(D),grandTotal:R,metadata:T});n({message:a(),status:t(),data:x});n({glNumber:a(),colors:o(a()),colorCount:t()});const d="/api",h={getMatrix:r=>c.get(`${d}/gls/matrix-date`,{params:r,paramsSerializer:s=>u.stringify(s,{arrayFormat:"brackets"})}).then(s=>s.data),getList:r=>c.get(`${d}/gls/list`,{params:{gl_number:r},paramsSerializer:s=>u.stringify(s,{arrayFormat:"brackets"})}).then(s=>s.data)},I=n({glNo:a(),date:a(),size:a(),totalBundle:t(),totalPcs:g([a(),t()]),totalDefect:g([a(),t()]),lineNames:a(),totalColors:t()}),w=n({size:a(),totalPcs:t(),totalBundle:t()}),M=n({color:a(),totalPcs:t(),totalBundle:t(),totalSizes:t(),totalDefect:t().optional(),lineNames:a(),sizes:o(w)}),O=n({glNo:a(),sizes:o(w),colors:o(M)}),F=n({status:m(),message:a(),glNo:a(),hasRecentData:m(),startDate:a(),endDate:a(),count:t(),data:o(I),summary:O}),$=n({id:t(),cuttingGlColorId:t(),size:a(),orderQty:t(),cutQty:t(),stockOutQty:t(),replacementQty:t(),createdAt:a(),updatedAt:a(),sewingStockinQty:t(),sewingStockoutQty:t()}),q=n({id:t(),cuttingGlSummaryId:t(),color:a(),type:a(),orderQty:t(),cutQty:t(),stockOutQty:t(),replacementQty:t(),lastSyncAt:a(),createdAt:a(),updatedAt:a(),sewingTotalStockinQty:t(),sewingTotalStockoutQty:t(),sizes:o($)}),G=n({id:t(),glNumber:a(),orderQty:t(),cutQty:t(),stockOutQty:t(),replacementQty:t(),lastSyncAt:a(),sewingTotalStockinQty:t(),sewingTotalStockoutQty:t(),colors:o(q)}),U=n({status:m(),message:a(),data:G});G.omit({colors:!0});const K=b("gls",{state:()=>({data:[],searchResult:[],isSearching:!1,meta:{},links:{},loading:!1,error:null,currentPage:1,lastPage:1,search:"",summaryGl:[],summaryByColor:[],total:{},metaSummary:{},matrixData:[],matrixSummary:{}}),actions:{async fetch(r={}){this.loading=!0,this.error=null;try{const s={page:r.page??1,perPage:r.perPage??50,q:r.q??void 0,dateFrom:r.dateFrom,dateTo:r.dateTo};r.q&&(this.searchResult=[],this.isSearching=!0);const e=await c.get("/api/gls",{params:s}),l=L.parse(e.data);return this.meta=l.meta,this.links=l.links,this.currentPage=l.meta.currentPage,this.lastPage=l.meta.lastPage,r.q?this.searchResult=l.data:(this.data=l.data,this.isSearching=!1,this.searchResult=[]),i.parse({success:!0,message:l.message??"Gl Numbers loaded"})}catch(s){const e=s?.response?.data?.message||"Something went wrong";return this.error=e,i.parse({success:!1,message:e})}finally{this.loading=!1}},async fetchGLNumber(r){this.loading=!0,this.error=null;try{const e=(await c.get(`/api/gls/number/${r}`)).data;return i.parse({success:!0,message:e.message??"Gl Numbers loaded",id:e.data.id})}catch(s){const e=s?.response?.data?.message||"Something went wrong";return this.error=e,i.parse({success:!1,message:e})}finally{this.loading=!1}},async fetchSummaryGl(r){this.loading=!0,this.error=null;try{const s=await c.get("/api/gls/cutting-summary",{params:{glNumber:r}}),e=s.data;return this.summaryGl=e.data.summaryByGl,this.summaryByColor=e.data.summaryByColor,this.metaSummary=e.data.metadata,this.total=e.data.grandTotal,i.parse({success:!0,message:s.data.message??"Gl Numbers loaded",data:s.data.data})}catch(s){const e=s?.response?.data?.message||"Something went wrong";return this.error=e,i.parse({success:!1,message:e})}finally{this.loading=!1}},async fetchSyncCuttingGL(r){this.loading=!0,this.error=null;try{const s=await c.get("/api/gls/syncCuttingGlNumber",{params:{glNumber:r}}),e=U.parse(s.data);return console.log(e),i.parse({success:!0,message:s.data.message??"Gl Numbers loaded"})}catch(s){const e=s?.response?.data?.message||"Something went wrong";return this.error=e,i.parse({success:!1,message:e})}finally{this.loading=!1}},async fetchGLMatix(r){this.loading=!0,this.error=null;try{const s=await h.getMatrix(r),e=F.parse(s);return this.matrixData=e.data,this.matrixSummary=e.summary,i.parse({success:!0,message:e.message??"Summary Chart loaded",data:{startDate:e.startDate,endDate:e.endDate,glNo:e.glNo,summary:e.summary,chartData:e.data}})}catch(s){const e=s?.response?.data?.message||"Something went wrong";return this.error=e,i.parse({success:!1,message:e})}finally{this.loading=!1}},async fetchGLList(r){this.loading=!0,this.error=null;try{const s=await h.getList(r);return i.parse({success:!0,message:s.message??"GL Number List",data:s.data})}catch(s){const e=s?.response?.data?.message||"Something went wrong";return this.error=e,i.parse({success:!1,message:e})}finally{this.loading=!1}},async searchOrFetch(r){if(this.search!==r&&(this.searchResult=[],this.isSearching=!1),this.search=r,!r)return await this.fetch(),this.data;const s=this.data.filter(l=>l.glNumber?.toLowerCase().includes(r));return s.length>0?(this.searchResult=s,this.isSearching=!0,s):(await this.fetch({page:1,q:r})).success?this.searchResult:[]}},getters:{searchedItems:r=>{if(!r.search)return r.data;if(r.isSearching&&r.searchResult.length)return r.searchResult;const s=r.search.toLowerCase();return r.data.filter(e=>e.glNumber?.toLowerCase().includes(s))},options(){return this.searchedItems.map(r=>({value:r.glNumber||"",label:r.glNumber||""}))}}});export{J as G,U as a,K as u};
