import{E as c,D as p}from"./index-BL_L1Flw.js";import{q as S}from"./index-B-cYlh1f.js";import{M as u,L as g,A as i}from"./api.schema-363JpEzr.js";import{o as n,s as e,n as t,a as o,c as m,e as f,u as w}from"./types-D48y91Ee.js";const G=n({id:t().optional(),glNumber:e().min(1,"Line name is required"),createdAt:e().optional(),updatedAt:e().optional()}),Q=o(G),b=n({message:e(),data:Q,links:g,meta:u,status:m()}),C=n({glNo:e(),totalBundle:t(),totalPcs:t(),totalColors:t(),totalSizes:t(),lastUpdated:e(),lineNames:e()}),H=n({status:m(),message:e(),data:o(C),links:g,meta:u}),d=n({orderQty:t().int().nonnegative(),cutQty:t().int().nonnegative()}),h=n({size:e(),orderQty:t().int().nonnegative(),cutQty:t().int().nonnegative()}),k=n({id:t().optional(),color:e(),type:e(),summary:d,sizeBreakdown:o(h)}),N=n({orderQty:t().int().nonnegative(),cutQty:t().int().nonnegative()}),v=n({size:e(),orderQty:t().int().nonnegative(),cutQty:t().int().nonnegative()}),A=n({glNumber:e(),layingPlannings:o(k),glSummary:N,glSizeBreakdown:o(v)}),B=n({color:e(),type:f(["BODY","COMBINASI"]),summary:d,sizeBreakdown:o(h)}),R=n({orderQty:t().int().nonnegative(),cutQty:t().int().nonnegative()}),z=n({glNumbers:o(e())}),L=n({totalGlCount:t().int().positive(),totalColorCount:t().int().positive(),totalLayingPlannings:t().int().positive(),generatedAt:e(),lastUpdated:e(),filtersApplied:z}),T=n({message:e(),status:t(),data:n({summaryByGl:o(A),summaryByColor:o(B),grandTotal:R,metadata:L})}),P="/api",x={getMatrix:a=>c.get(`${P}/gls/matrix-date`,{params:a,paramsSerializer:r=>S.stringify(r,{arrayFormat:"brackets"})}).then(r=>r.data)},D=n({glNo:e(),date:e(),size:e(),totalBundle:t(),totalPcs:w([e(),t()]),lineNames:e(),totalColors:t()}),I=n({size:e(),totalPcs:t(),totalBundle:t(),totalColors:t()}),M=n({glNo:e(),sizes:o(I)}),O=n({status:m(),message:e(),glNo:e(),hasRecentData:m(),startDate:e(),endDate:e(),count:t(),data:o(D),summary:o(M)}),F=n({id:t(),cuttingGlColorId:t(),size:e(),orderQty:t(),cutQty:t(),stockOutQty:t(),replacementQty:t(),createdAt:e(),updatedAt:e(),sewingStockinQty:t(),sewingStockoutQty:t()}),q=n({id:t(),cuttingGlSummaryId:t(),color:e(),type:e(),orderQty:t(),cutQty:t(),stockOutQty:t(),replacementQty:t(),lastSyncAt:e(),createdAt:e(),updatedAt:e(),sewingTotalStockinQty:t(),sewingTotalStockoutQty:t(),sizes:o(F)}),y=n({id:t(),glNumber:e(),orderQty:t(),cutQty:t(),stockOutQty:t(),replacementQty:t(),lastSyncAt:e(),sewingTotalStockinQty:t(),sewingTotalStockoutQty:t(),colors:o(q)}),U=n({status:m(),message:e(),data:y});y.omit({colors:!0});const J=p("gls",{state:()=>({data:[],searchResult:[],isSearching:!1,meta:{},links:{},loading:!1,error:null,currentPage:1,lastPage:1,search:"",summaryGl:[],summaryByColor:[],total:{},metaSummary:{},matrixData:[],matrixSummary:[]}),actions:{async fetch(a={}){this.loading=!0,this.error=null;try{const r={page:a.page??1,perPage:a.perPage??50,q:a.q??void 0,dateFrom:a.dateFrom,dateTo:a.dateTo};a.q&&(this.searchResult=[],this.isSearching=!0);const s=await c.get("/api/gls",{params:r}),l=b.parse(s.data);return this.meta=l.meta,this.links=l.links,this.currentPage=l.meta.currentPage,this.lastPage=l.meta.lastPage,a.q?this.searchResult=l.data:(this.data=l.data,this.isSearching=!1,this.searchResult=[]),i.parse({success:!0,message:l.message??"Gl Numbers loaded"})}catch(r){const s=r?.response?.data?.message||"Something went wrong";return this.error=s,i.parse({success:!1,message:s})}finally{this.loading=!1}},async fetchGLNumber(a){this.loading=!0,this.error=null;try{const s=(await c.get(`/api/gls/number/${a}`)).data;return i.parse({success:!0,message:s.message??"Gl Numbers loaded",id:s.data.id})}catch(r){const s=r?.response?.data?.message||"Something went wrong";return this.error=s,i.parse({success:!1,message:s})}finally{this.loading=!1}},async fetchSummaryGl(a){this.loading=!0,this.error=null;try{const r=await c.get("/api/gls/cutting-summary",{params:{glNumber:a}}),s=T.parse(r.data);return this.summaryGl=s.data.summaryByGl,this.summaryByColor=s.data.summaryByColor,this.metaSummary=s.data.metadata,this.total=s.data.grandTotal,i.parse({success:!0,message:r.data.message??"Gl Numbers loaded"})}catch(r){const s=r?.response?.data?.message||"Something went wrong";return this.error=s,i.parse({success:!1,message:s})}finally{this.loading=!1}},async fetchSyncCuttingGL(a){this.loading=!0,this.error=null;try{const r=await c.get("/api/gls/syncCuttingGlNumber",{params:{glNumber:a}}),s=U.parse(r.data);return console.log(s),i.parse({success:!0,message:r.data.message??"Gl Numbers loaded"})}catch(r){const s=r?.response?.data?.message||"Something went wrong";return this.error=s,i.parse({success:!1,message:s})}finally{this.loading=!1}},async fetchGLMatix(a){this.loading=!0,this.error=null;try{const r=await x.getMatrix(a),s=O.parse(r);return this.matrixData=s.data,this.matrixSummary=s.summary,i.parse({success:!0,message:s.message??"Summary Chart loaded"})}catch(r){const s=r?.response?.data?.message||"Something went wrong";return this.error=s,i.parse({success:!1,message:s})}finally{this.loading=!1}},async searchOrFetch(a){if(this.search!==a&&(this.searchResult=[],this.isSearching=!1),this.search=a,!a)return await this.fetch(),this.data;const r=this.data.filter(l=>l.glNumber?.toLowerCase().includes(a));return r.length>0?(this.searchResult=r,this.isSearching=!0,r):(await this.fetch({page:1,q:a})).success?this.searchResult:[]}},getters:{searchedItems:a=>{if(!a.search)return a.data;if(a.isSearching&&a.searchResult.length)return a.searchResult;const r=a.search.toLowerCase();return a.data.filter(s=>s.glNumber?.toLowerCase().includes(r))},options(){return this.searchedItems.map(a=>({value:a.glNumber||"",label:a.glNumber||""}))}}});export{H as G,U as a,J as u};
