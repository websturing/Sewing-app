import{_ as G}from"./BaseButton.vue_vue_type_script_setup_true_lang-DrlZO3Gi.js";import{_ as Z}from"./BaseInput.vue_vue_type_script_setup_true_lang-DSmWDPMD.js";import{d as S}from"./dayjs.min-lasCq60O.js";import{S as ee}from"./SearchOutline-COIoJHxm.js";import{R as te}from"./RefreshRound-BwLqLklE.js";import{d as D,r as w,k as V,q as F,c as u,o as l,a as e,e as n,t as p,g as r,f as m,L as z,w as d,F as L,H as $,E as ne,D as se,p as oe,s as le,m as C,l as k,h as ae,j as ie,y as re}from"./index-Bj9qeEx5.js";import{q as de}from"./index-B-cYlh1f.js";import{o as j,s as x,n as O,a as ce,c as ue}from"./types-CVZIcfwR.js";import{A as P}from"./api.schema-BgX2oz3V.js";import{G as pe,I as me,C as q,a as _e,A as ge,L as fe,O as he,S as ye,H as ve,D as be}from"./IosTrendingUp-DEUogBHD.js";import{a as xe}from"./line.page-BoHEP3nR.js";import{B as U}from"./BrandAirtable-FeMovrdh.js";import{S as Le}from"./SmartHome-Bz6KG4KA.js";import"./_commonjsHelpers-CE1G-McA.js";import"./stockin.api.schema-DJB3WlbE.js";const $e={class:"flex flex-col gap-3"},we={class:"flex justify-between items-center"},Ce={class:"font-semibold"},De={class:"flex gap-2 justify-end"},Ne={key:1},ke=D({__name:"AttendancesGroupLineTable",props:{groupLine:{},isLoading:{type:Boolean,default:!0},highlightTrigger:{type:[Number,Boolean]}},emits:["click:refresh"],setup(g,{emit:c}){const o=S(new Date).format("MMMM DD, YYYY"),s=w(""),t=g,f=c,v=V(()=>s.value?t.groupLine.filter(y=>y.userName.toLowerCase().includes(s.value.toLowerCase())||y.employeeCode.toLowerCase().includes(s.value.toLowerCase())):t.groupLine),h=w(!1);return F(()=>t.highlightTrigger,()=>{h.value=!0,setTimeout(()=>{h.value=!1},800)},{immediate:!1}),(y,_)=>{const b=m("n-table");return l(),u("div",$e,[e("div",we,[e("p",Ce,"Attendance List | "+p(r(o)),1),e("div",De,[n(Z,{icon:r(ee),placeholder:"Search",modelValue:s.value,"onUpdate:modelValue":_[0]||(_[0]=a=>s.value=a)},null,8,["icon","modelValue"]),n(G,{label:"Refresh",icon:r(te),onClick:_[1]||(_[1]=a=>f("click:refresh"))},null,8,["icon"])])]),n(b,{class:z({"bg-yellow-200 ring-2 ring-yellow-400":h.value,"bg-white":!h.value})},{default:d(()=>[_[3]||(_[3]=e("thead",null,[e("tr",null,[e("th",null,"Employee ID"),e("th",null,"Employee Name"),e("th",null,"Date"),e("th",null,"Status"),e("th",null,"Check-in Time"),e("th",null,"Check-out Time")])],-1)),e("tbody",null,[y.isLoading?(l(),u("tr",Ne,[..._[2]||(_[2]=[e("td",{colspan:"6",class:"!text-center py-5"}," Loading... ",-1)])])):(l(!0),u(L,{key:0},$(v.value,a=>(l(),u("tr",{key:a.id},[e("td",null,p(a.employeeCode),1),e("td",null,p(a.userName),1),e("td",null,p(a.attendanceDate),1),e("td",null,p(a.status),1),e("td",null,p(a.checkInTime||"N/A"),1),e("td",null,p(a.checkOutTime||"N/A"),1)]))),128))])]),_:1},8,["class"])])}}}),Ae="/api",Ge={getAttendanceByLine:(g,c)=>ne.get(`${Ae}/attendance/group/line/${g}`,{params:c,paramsSerializer:o=>de.stringify(o,{arrayFormat:"brackets"})}).then(o=>o.data)},Te=j({id:O().optional(),attendanceDate:x(),employeeCode:x(),lineId:O(),lineName:x(),checkInTime:x().nullable(),checkOutTime:x().nullable(),status:x(),userName:x(),deviceName:x().nullable()}),He=j({status:ue(),message:x(),data:ce(Te)}),Se=se("attendance",{state:()=>({groupLine:[],isLoading:!1,error:null}),actions:{async fetchGroupLine(g){this.isLoading=!0,this.error=null;try{const c=await Ge.getAttendanceByLine(g,{}),o=He.parse(c);return this.groupLine=o.data,P.parse({success:!0,message:o.message??"Attendances By Group Line loaded",data:{attendanceGroupLine:o.data}})}catch(c){const o=c?.response?.data?.message||"Something went wrong";return this.error=o,P.parse({success:!1,message:o})}finally{this.isLoading=!1}}}});function Fe(){const g=oe(),c=Se(),{groupLine:o,isLoading:s}=le(c);return{groupLine:o,isLoading:s,handleFetch:async(f={notify:!0},v)=>{const{success:h,message:y}=await c.fetchGroupLine(v);f.notify&&(h?g.success(y):g.error(y))}}}const ze={class:"flex items-center gap-2"},Me={class:"text-3xl font-bold mt-2"},Ee={class:"flex items-center gap-5"},Be={class:"bg-green-50 rounded px-3"},Ie=D({__name:"EmployeeAttendanceCard",props:{EmployeeAttendCount:{default:0}},setup(g){const c=g;return(o,s)=>{const t=m("n-icon"),f=m("n-card");return l(),u("div",null,[n(f,null,{default:d(()=>[e("div",ze,[n(t,{component:r(pe),size:"24"},null,8,["component"]),s[0]||(s[0]=e("p",null,"Employee Attend",-1))]),e("p",Me,p(c.EmployeeAttendCount),1),e("div",Ee,[s[2]||(s[2]=e("p",null,"Last Week",-1)),e("p",Be,[n(t,{size:"16",component:r(me),class:"text-green-500"},null,8,["component"]),s[1]||(s[1]=C(" 2,5% ",-1))])])]),_:1})])}}}),Re={class:"flex items-center gap-2"},Ye=D({__name:"EmployeeLeaderCard",props:{highlightTrigger:{type:[Number,Boolean]}},setup(g){const c=g,o=w(!1);return F(()=>c.highlightTrigger,()=>{o.value=!0,setTimeout(()=>{o.value=!1},800)},{immediate:!1}),(s,t)=>{const f=m("n-icon"),v=m("n-card");return l(),u("div",null,[n(v,{class:z({"bg-yellow-200 ring-2 ring-yellow-400":o.value,"bg-white":!o.value})},{default:d(()=>[e("div",Re,[n(f,{component:r(q),size:"24"},null,8,["component"]),t[0]||(t[0]=e("p",null,"Leader",-1))]),t[1]||(t[1]=e("p",{class:"text-3xl font-bold mt-2"}," Administrator ",-1))]),_:1},8,["class"])])}}}),Oe={class:"flex flex-col gap-5 border border-gray-200 px-2 py-4 rounded-lg shadow-sm"},Pe={class:"!w-full"},Ue={class:"flex items-center gap-4"},Ve={class:"bg-blue-50 pl-3 pr-3 pt-3 pb-2 rounded-xl"},je={class:"flex flex-col"},qe={class:"text-lg font-semibold"},We={class:"text-gray-400"},Je={class:"bg-gray-50 p-5 rounded-lg"},Ke=D({__name:"LineDeviceCard",props:{lineDevices:{default:()=>[]}},setup(g){const c=g;return(o,s)=>{const t=m("n-icon"),f=m("n-collapse-item"),v=m("n-collapse");return l(),u("div",Oe,[n(v,{"arrow-placement":"right"},{default:d(()=>[(l(!0),u(L,null,$(c.lineDevices,(h,y)=>(l(),k(f,{key:y,name:y},{header:d(()=>[e("div",Pe,[e("div",Ue,[e("div",Ve,[n(t,{size:"24",class:"text-blue-700"},{default:d(()=>[n(r(_e))]),_:1})]),e("div",je,[e("p",qe,p(h.deviceName),1),e("p",We,p(h.deviceDescription),1)])])])]),default:d(()=>[e("div",Je,[e("table",null,[e("tr",null,[s[0]||(s[0]=e("td",null,"Mac Address",-1)),s[1]||(s[1]=e("td",null,"   :   ",-1)),e("td",null,p(h.deviceMacAddress),1)]),e("tr",null,[s[2]||(s[2]=e("td",null,"Last Updated",-1)),s[3]||(s[3]=e("td",null,"   :   ",-1)),e("td",null,p(h.updatedAt),1)])])])]),_:2},1032,["name"]))),128))]),_:1})])}}}),Qe={key:0},Xe={class:"flex justify-between items-center"},Ze={class:"font-semibold"},et={class:"flex gap-2 text-sm text-gray-500"},tt={class:"text-xs text-blue-400"},nt=["onClick"],st={key:1},ot=D({__name:"LineGLHistoryTimeline",props:{lineHistoryGLNumber:{default:()=>[]}},setup(g){const c=ae(),o=g,s=V(()=>o.lineHistoryGLNumber&&o.lineHistoryGLNumber.length>0),t=f=>{c.push({name:"gls-detail",params:{id:f}})};return(f,v)=>{const h=m("n-icon"),y=m("n-timeline-item"),_=m("n-timeline"),b=m("n-empty");return l(),u("div",null,[s.value?(l(),u("div",Qe,[n(_,null,{default:d(()=>[(l(!0),u(L,null,$(f.lineHistoryGLNumber,(a,H)=>(l(),k(y,{key:a.glNo,type:H==0?"success":"default"},{default:d(()=>[e("div",Xe,[e("div",null,[e("p",Ze,p(a.glNo),1),e("div",et,[e("p",null,"Color : "+p(a.totalColors),1),e("p",null,"Cut Pieces : "+p(a.totalPcs),1)]),e("p",tt,p(a.updatedAt),1)]),e("div",{class:"hover:text-blue-500 cursor-pointer",onClick:M=>t(a.glNo)},[n(h,{component:r(ge),size:18},null,8,["component"])],8,nt)])]),_:2},1032,["type"]))),128))]),_:1})])):(l(),u("div",st,[n(b,{description:"No History GL Number Found"})]))])}}}),lt={class:"flex gap-2 flex-wrap"},at=["colspan"],it={class:"!text-center"},rt={class:"font-semibold !text-center"},dt={class:"!text-red-400 !text-center font-semibold"},ct={class:"!bg-gray-50 !text-center"},ut=D({__name:"LineGlSummary",props:{data:{default:()=>[]}},setup(g){const c=g,o=w(null);return F(()=>c.data,s=>{s.length>0&&!o.value&&(o.value=s[0].glNo)},{immediate:!0}),(s,t)=>{const f=m("n-table"),v=m("n-tab-pane"),h=m("n-tabs"),y=m("n-empty");return c.data.length>0?(l(),k(h,{key:0,value:o.value,"onUpdate:value":t[0]||(t[0]=_=>o.value=_),type:"card",animated:""},{default:d(()=>[(l(!0),u(L,null,$(c.data,_=>(l(),k(v,{key:_.glNo,name:_.glNo,tab:`GL-${_.glNo.toString()}`},{default:d(()=>[e("div",lt,[(l(!0),u(L,null,$(_.colors,b=>(l(),k(f,{class:"flex-1"},{default:d(()=>[e("thead",null,[e("tr",null,[t[1]||(t[1]=e("th",null,"Color",-1)),e("th",{colspan:b.sizes.length,class:"!text-center"},p(b.color),9,at)]),e("tr",null,[t[2]||(t[2]=e("th",null,"Size",-1)),(l(!0),u(L,null,$(b.sizes,a=>(l(),u("th",it,p(a.size),1))),256))])]),e("tbody",null,[e("tr",null,[t[3]||(t[3]=e("td",null,"CUT PIECE IN",-1)),(l(!0),u(L,null,$(b.sizes,a=>(l(),u("td",rt,p(a.pcs),1))),256))]),e("tr",null,[t[4]||(t[4]=e("td",null,"DEFECT",-1)),(l(!0),u(L,null,$(b.sizes,a=>(l(),u("td",dt,p(a.defect),1))),256))]),e("tr",null,[t[5]||(t[5]=e("td",{class:"!bg-gray-50"},"DIFF",-1)),(l(!0),u(L,null,$(b.sizes,a=>(l(),u("td",ct,p(Number(a.pcs)-Number(a.defect)),1))),256))])])]),_:2},1024))),256))])]),_:2},1032,["name","tab"]))),128))]),_:1},8,["value"])):(l(),k(y,{key:1,size:"huge",description:"No GL Summary Data Available"}))}}}),pt={class:"flex flex-col gap-5"},mt={class:"flex flex-col gap-10"},_t={class:"flex items-center gap-4"},gt={class:"bg-blue-50 pl-3 pr-3 pt-3 pb-2 rounded-xl"},ft={class:"flex flex-col gap-2"},ht={class:"text-xl font-bold"},yt={class:"flex gap-4 items-center"},vt={class:"flex gap-2 items-center bg-gray-100 px-4 rounded-lg"},bt={class:"text-gray-700"},xt={class:"flex gap-2 items-center bg-teal-100 px-4 rounded-lg"},Lt={class:"w-16 flex-auto text-right"},$t={class:"flex gap-1"},wt={class:"flex flex-col gap-5"},Ct={class:"flex-1"},Dt={class:"lg:w-80 xl:w-96 flex flex-col gap-2"},Nt={class:"bg-gray-50 rounded-lg p-5"},kt={class:"flex flex-col gap-2"},At={class:"bg-gray-50 p-5 rounded-lg"},Vt=D({__name:"LinesDetailPageView",setup(g){const c=ie(),o=w(!1),s=w(!1),t=c.params.id,f=w(0),v=w(0),{line:h,lineDevices:y,lineStockInSummary:_,lineHistoryGLNumber:b,handleFetchById:a,handleFetchLineDevices:H,handleHistoryGlNumber:M}=xe(),{groupLine:E,isLoading:W,handleFetch:B}=Fe(),J=()=>{console.log(t),t&&B({notify:!0},t)},K=T=>{t&&H(t,{notify:T})},Q=()=>{s.value=!0,t&&M(t,{notify:!0})};return re(()=>{if(t){const T=S().format("YYYY-MM-DD"),i=S().subtract(14,"day").format("YYYY-MM-DD");a({notify:!0},{id:t,startDate:i,endDate:T}),B({notify:!1},t),K(!1)}}),(T,i)=>{const A=m("n-icon"),I=m("n-breadcrumb-item"),X=m("n-breadcrumb"),R=m("n-card"),Y=m("n-modal");return l(),u("div",pt,[n(R,null,{default:d(()=>[e("div",mt,[e("div",_t,[e("div",gt,[n(A,{size:"48"},{default:d(()=>[n(r(U))]),_:1})]),e("div",ft,[e("p",ht," Line "+p(r(h)?.name),1),e("div",yt,[e("div",vt,[n(A,{size:"14",class:"text-gray-700"},{default:d(()=>[n(r(fe))]),_:1}),e("p",bt,p(r(h)?.location),1)]),e("div",xt,[n(A,{size:"16",class:"text-green-800"},{default:d(()=>[n(r(he))]),_:1}),i[5]||(i[5]=e("p",{class:"text-teal-700"},"Online",-1))])])]),e("div",Lt,[n(X,null,{default:d(()=>[n(I,null,{default:d(()=>[n(A,{component:r(Le)},null,8,["component"]),i[6]||(i[6]=C(" Home",-1))]),_:1}),n(I,null,{default:d(()=>[n(A,{component:r(U)},null,8,["component"]),i[7]||(i[7]=C(" Lines ",-1))]),_:1})]),_:1})])]),e("div",$t,[n(G,{icon:r(ye),onClick:i[0]||(i[0]=N=>f.value=Date.now())},{default:d(()=>[...i[8]||(i[8]=[C("Attendances ",-1)])]),_:1},8,["icon"]),n(G,{icon:r(q),onClick:i[1]||(i[1]=N=>v.value=Date.now())},{default:d(()=>[...i[9]||(i[9]=[C("Leaders ",-1)])]),_:1},8,["icon"]),n(G,{icon:r(ve),onClick:Q},{default:d(()=>[...i[10]||(i[10]=[C("History GL Numbers ",-1)])]),_:1},8,["icon"]),n(G,{icon:r(be),onClick:i[2]||(i[2]=N=>o.value=!0)},{default:d(()=>[...i[11]||(i[11]=[C("Devices",-1)])]),_:1},8,["icon"])])])]),_:1}),n(R,{class:"shadow-sm"},{default:d(()=>[e("div",wt,[e("div",{class:z(["flex",r(_).length>0?"items-end":"items-center","gap-5"])},[e("div",Ct,[n(ut,{data:r(_)},null,8,["data"])]),e("div",Dt,[n(Ye,{"highlight-trigger":v.value},null,8,["highlight-trigger"]),n(Ie,{EmployeeAttendCount:r(E).length},null,8,["EmployeeAttendCount"])])],2),e("div",Nt,[n(ke,{"highlight-trigger":f.value,groupLine:r(E),isLoading:r(W),"onClick:refresh":J},null,8,["highlight-trigger","groupLine","isLoading"])])])]),_:1}),n(Y,{show:o.value,"onUpdate:show":i[3]||(i[3]=N=>o.value=N),title:"Line Devices",closable:!0,preset:"card",style:{width:"600px"}},{default:d(()=>[n(Ke,{lineDevices:r(y)},null,8,["lineDevices"])]),_:1},8,["show"]),n(Y,{show:s.value,"onUpdate:show":i[4]||(i[4]=N=>s.value=N),title:"GL Transaction History",closable:!0,preset:"card",style:{width:"600px"}},{default:d(()=>[e("div",kt,[e("div",At,[n(ot,{lineHistoryGLNumber:r(b)},null,8,["lineHistoryGLNumber"])])])]),_:1},8,["show"])])}}});export{Vt as default};
