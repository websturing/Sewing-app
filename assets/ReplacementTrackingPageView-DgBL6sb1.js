import{_ as N}from"./BaseIconWithLabel.vue_vue_type_script_setup_true_lang-CpSPTeej.js";import{_ as Q}from"./BaseInput.vue_vue_type_script_setup_true_lang-CLu1dz_B.js";import{r as x,p as X,d as B,c as $,e as o,a as t,f as C,w as b,t as D,g,F as Y,H as Z,o as A,m as M,I as ee}from"./index-BXp2mkfJ.js";import{u as te}from"./replacement.store-BjhZBmQ0.js";import{S as ae,I as se}from"./InsightsRound-D98UVS9m.js";import{C as ne,F as le}from"./FolderPerson16Regular-B57rWPpN.js";import{S as oe}from"./SmartHome-Cze3Mov4.js";import"./index-B-cYlh1f.js";import"./_commonjsHelpers-CE1G-McA.js";import"./defect.summaryApi-Bar6lMpN.js";import"./types-CVZIcfwR.js";import"./metaPagination-BMwnZfrC.js";import"./api.schema-B7NsqcGR.js";let d;const re=()=>{const r=x(!1),e=x(null),i=x(null);d=X();const s=new Map,l=x(null);let n=null,c=null,a=null;const y=async(u,q={})=>{const{minLoadingTime:I=500,notify:w=!1,showLoadingToast:W=!1,loadingMessage:z="Loading...",retryAttempts:h=0,retryDelay:j=1e3,manualRetry:R=!1,cache:L=!1,cacheTime:O=300*1e3,onSuccess:P,onError:V,onRetry:U,onCancel:G,abortSignal:J}=q;c=u,a=q;const T=L?u.toString():"";if(L&&T){const f=s.get(T);if(f&&Date.now()-f.timestamp<O)return i.value=f.data,w&&d.success("Data loaded from cache"),P?.(f.data),f.data}r.value=!0,e.value=null,J||(l.value=new AbortController),W&&(n=d.loading(z,{duration:0,closable:!0,onClose:()=>{E(),G?.()}}));let F="";try{const f=R?1:h+1;for(let v=0;v<f;v++)try{const[k]=await Promise.all([u(),new Promise(K=>setTimeout(K,I))]),{success:p,message:m,data:S}=k;if(p)return i.value=S,L&&T&&s.set(T,{data:S,timestamp:Date.now()}),w&&d.success(m||"Success!"),P?.(S),S;e.value=m,F=m,R?_(m):v===h&&(w&&d.error(m),V?.(m))}catch(k){if(k.name==="AbortError")return e.value="Request was cancelled",null;const p=k.message||"An unexpected error occurred.";if(F=p,!R&&v<h){e.value=null,U?.(v+1),w&&d.warning(`Retrying... (${v+1}/${h})`),await new Promise(m=>setTimeout(m,j));continue}e.value=p,R?_(p):(w&&d.error(p),V?.(p))}return null}finally{r.value=!1,n&&(n.destroy(),n=null)}},_=u=>{d.error(u,{duration:1500,closable:!0})},H=async()=>!c||!a?(console.warn("No previous request to retry"),null):await y(c,a),E=()=>{l.value&&(l.value.abort(),l.value=null,r.value=!1),n&&(n.destroy(),n=null)};return{isLoading:r,error:e,data:i,execute:y,retry:H,cancel:E,clearCache:u=>{u?s.delete(u):s.clear()},reset:()=>{r.value=!1,e.value=null,i.value=null,E()}}};function ie(){const r=te(),{isLoading:e,error:i,data:s,execute:l}=re();return{isLoading:e,error:i,data:s,fetchTrackingData:async c=>await l(()=>r.fetchTicketTrackBySerial(c),{notify:!1,showLoadingToast:!0,loadingMessage:`Searching for ${c}...`,minLoadingTime:500,retryAttempts:2,retryDelay:1500,manualRetry:!0})}}const ce={class:"flex flex-col gap-5"},ue={class:"flex gap-2 flex-wrap"},me={class:"flex flex-col gap-2"},de={class:"flex flex-col gap-1"},fe=B({__name:"ReplacementTracking",setup(r){const e=x(null),{isLoading:i,error:s,fetchTrackingData:l}=ie(),n=()=>{l(e.value||"")};return(c,a)=>{const y=C("n-card");return A(),$("div",ce,[o(y,{class:"!bg-gray-50 !border !border-gray-200"},{default:b(()=>[a[1]||(a[1]=M(" SWA-REPLACEMENT-20251208141755-65830-01 ",-1)),t("div",null,[o(Q,{modelValue:e.value,"onUpdate:modelValue":a[0]||(a[0]=_=>e.value=_),icon:g(ae),placeholder:"Search Replacement Request",onEnter:n,loading:g(i)},null,8,["modelValue","icon","loading"])])]),_:1}),t("div",null,[a[2]||(a[2]=t("p",{class:"font-semibold text-lg"},"Replacement Request Workflow",-1)),t("p",null,"Track the steps and status for Ticket : "+D(e.value),1),t("p",null,D(g(s)),1)]),t("div",ue,[(A(),$(Y,null,Z(10,_=>o(y,{key:_,class:"!w-[263px] !lg:w-[20%] !md:w-[30%] !sm:w-[55%] !max-w-[350px]"},{default:b(()=>[t("div",me,[a[3]||(a[3]=t("p",null,"Replacement Request Created",-1)),a[4]||(a[4]=t("div",{class:"flex"},[t("div",{class:"text-xs px-2 py-0.5 bg-red-100 inline-flex"},"Progress")],-1)),t("div",de,[o(N,{icon:g(ne),label:"December 08, 2025 14:17",size:14},null,8,["icon"]),o(N,{icon:g(le),label:"gita(gita@ghimli.com)",size:16},null,8,["icon"])])])]),_:2},1024)),64))])])}}}),pe={class:"flex flex-col gap-10"},ge={class:"flex justify-between items-center"},_e={class:"w-84 flex-auto"},ve={class:"text-xl font-bold mb-1"},xe={class:"w-16 flex-auto text-right"},qe=B({__name:"ReplacementTrackingPageView",setup(r){const e=x({title:"Track Request Status & Progress",description:"Monitor the current stage, real-time status, and detailed progress history of your replacement requests."});return ee({title:e.value.title,meta:[{name:"description",content:e.value.description}]}),(i,s)=>{const l=C("n-icon"),n=C("n-breadcrumb-item"),c=C("n-breadcrumb");return A(),$("div",pe,[t("div",ge,[t("div",_e,[t("h2",ve,D(e.value.title),1),t("p",null,D(e.value.description),1)]),t("div",xe,[o(c,null,{default:b(()=>[o(n,null,{default:b(()=>[o(l,{component:g(oe)},null,8,["component"]),s[0]||(s[0]=M(" Home",-1))]),_:1}),o(n,null,{default:b(()=>[o(l,{component:g(se)},null,8,["component"]),s[1]||(s[1]=M(" Track Replacement Request ",-1))]),_:1})]),_:1})])]),o(fe)])}}});export{qe as default};
