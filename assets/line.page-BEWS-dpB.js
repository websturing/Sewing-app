import{E as h,D as A,p as D,s as k}from"./index-KKLjXh5o.js";import{q as f}from"./index-B-cYlh1f.js";import{s as G}from"./stockin.api.schema-cou0zUz2.js";import{M as N,L as H}from"./metaPagination-BMwnZfrC.js";import{o,s as a,n as i,a as u,c as y}from"./types-CVZIcfwR.js";import{A as c}from"./api.schema-B7NsqcGR.js";const p="/api",g={getlines:t=>h.get(`${p}/lines`,{params:t,paramsSerializer:e=>f.stringify(e,{arrayFormat:"brackets"})}).then(e=>e.data),getlineById:t=>{const{id:e,...s}=t;return h.get(`${p}/lines/${e}`,{params:s,paramsSerializer:d=>f.stringify(d,{arrayFormat:"brackets"})}).then(d=>d.data)},getLineDevices:t=>h.get(`${p}/lines/${t}/devices`).then(e=>e.data),getHistoryGLNumber:t=>h.get(`${p}/lines/${t}/history-glnumber`).then(e=>e.data)},I=o({id:i().optional(),name:a().min(1,"Line name is required"),location:a().nullable(),latestStockin:G.nullable()}),F=o({id:i().optional(),name:a().min(1,"Line name is required"),location:a().nullable()}),B=o({size:a(),bundle:i().int().nonnegative(),pcs:a().or(i()),defect:a().or(i())}),$=o({color:a(),totalBundle:i().int().nonnegative(),totalPcs:i().int().nonnegative(),totalDefect:i().int().nonnegative(),sizes:u(B)}),L=o({glNo:a(),totalColors:i().int().positive(),totalPcs:i().int().nonnegative(),colors:u($)}),R=o({message:a(),data:o({line:F,stockinSummary:u(L)}),status:y()}),T=L.extend({updatedAt:a().nullable().optional()}).omit({colors:!0}),q=o({message:a(),data:u(T),status:y()}),z=u(I),P=o({message:a(),data:z,links:H,meta:N,status:y()}),M=o({id:i().optional(),lineName:a().nullable().optional(),deviceId:i().nullable().optional(),deviceName:a().nullable().optional(),deviceMacAddress:a().nullable().optional(),deviceDescription:a().nullable().optional(),updatedAt:a().nullable().optional()}),x=o({message:a(),data:u(M),status:y()}),C=A("lines",{state:()=>({data:[],lineDevices:[],lineHistoryGLNumber:[],meta:{},links:{},loading:!1,error:null,line:{},lineStockInSummary:[]}),actions:{async fetchLines(t){this.loading=!0,this.error=null;try{const e=await g.getlines(t),s=P.parse(e);return this.data=s.data,this.meta=s.meta,this.links=s.links,c.parse({success:!0,message:s.message??"Lines loaded"})}catch(e){const s=e?.response?.data?.message||"Something went wrong";return this.error=s,c.parse({success:!1,message:s})}finally{this.loading=!1}},async fetchLineById(t){this.loading=!0,this.error=null;try{const e=await g.getlineById(t),s=R.parse(e);return this.line=s.data.line,this.lineStockInSummary=s.data.stockinSummary,c.parse({success:!0,message:s.message??"Lines loaded"})}catch(e){const s=e?.response?.data?.message||"Something went wrong";return this.error=s,c.parse({success:!1,message:s})}finally{this.loading=!1}},async fetchLineDevices(t){this.loading=!0,this.error=null;try{const e=await g.getLineDevices(t),s=x.parse(e);return this.lineDevices=s.data,c.parse({success:!0,message:s.message??"Lines loaded"})}catch(e){const s=e?.response?.data?.message||"Something went wrong";return this.error=s,c.parse({success:!1,message:s})}finally{this.loading=!1}},async fetchHistoryGLNumber(t){this.loading=!0,this.error=null;try{const e=await g.getHistoryGLNumber(t),s=q.parse(e);return this.lineHistoryGLNumber=s.data,c.parse({success:!0,message:s.message??"Lines loaded"})}catch(e){const s=e?.response?.data?.message||"Something went wrong";return this.error=s,c.parse({success:!1,message:s})}finally{this.loading=!1}}}});function Y(){const t=D(),e=C(),{data:s,line:d,lineStockInSummary:S,loading:b,lineDevices:v,lineHistoryGLNumber:w}=k(e);return{data:s,line:d,lineStockInSummary:S,loading:b,lineDevices:v,handleHistoryGlNumber:async(l,m={notify:!0})=>{const{success:r,message:n}=await e.fetchHistoryGLNumber(l);return m.notify&&(r?t.success(n):t.error(n)),{success:r,message:n}},lineHistoryGLNumber:w,handleFetch:async(l={notify:!0},m)=>{const{success:r,message:n}=await e.fetchLines(m);return l.notify&&(r?t.success(n):t.error(n)),{success:r,message:n}},handleFetchById:async(l={notify:!0},m)=>{const{success:r,message:n}=await e.fetchLineById(m);return l.notify&&(r?t.success(n):t.error(n)),{success:r,message:n}},handleFetchLineDevices:async(l,m={notify:!0})=>{const{success:r,message:n}=await e.fetchLineDevices(l);return m.notify&&(r?t.success(n):t.error(n)),{success:r,message:n}}}}export{C as a,Y as u};
