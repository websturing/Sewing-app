import{E as c,D as b}from"./index-Bxx76-Ez.js";import{q as u}from"./index-B-cYlh1f.js";import{M as y,L as p}from"./metaPagination-9MSE0uSw.js";import{o as n,s as e,n as t,a as o,c as m,f as Q,u as g}from"./types-CVZIcfwR.js";import{A as i}from"./api.schema-B7NsqcGR.js";const N=n({id:t().optional(),glNumber:e().min(1,"Line name is required"),createdAt:e().optional(),updatedAt:e().optional()}),C=o(N),k=n({message:e(),data:C,links:p,meta:y,status:m()}),L=n({glNo:e(),totalBundle:t(),totalPcs:t(),totalColors:t(),totalSizes:t(),lastUpdated:e(),lineNames:e()}),J=n({status:m(),message:e(),data:o(L),links:p,meta:y}),S=n({orderQty:t().int().nonnegative(),cutQty:t().int().nonnegative()}),f=n({size:e(),orderQty:t().int().nonnegative(),cutQty:t().int().nonnegative()}),v=n({id:t().optional(),color:e(),type:e(),summary:S,sizeBreakdown:o(f)}),z=n({orderQty:t().int().nonnegative(),cutQty:t().int().nonnegative()}),A=n({size:e(),orderQty:t().int().nonnegative(),cutQty:t().int().nonnegative()}),B=n({glNumber:e(),layingPlannings:o(v),glSummary:z,glSizeBreakdown:o(A)}),D=n({color:e(),type:Q(["BODY","COMBINASI"]),summary:S,sizeBreakdown:o(f)}),R=n({orderQty:t().int().nonnegative(),cutQty:t().int().nonnegative()}),P=n({glNumbers:o(e())}),T=n({totalGlCount:t().int().positive(),totalColorCount:t().int().positive(),totalLayingPlannings:t().int().positive(),generatedAt:e(),lastUpdated:e(),filtersApplied:P}),x=n({message:e(),status:t(),data:n({summaryByGl:o(B),summaryByColor:o(D),grandTotal:R,metadata:T})});n({glNumber:e(),colors:o(e()),colorCount:t()});const d="/api",h={getMatrix:r=>c.get(`${d}/gls/matrix-date`,{params:r,paramsSerializer:s=>u.stringify(s,{arrayFormat:"brackets"})}).then(s=>s.data),getList:r=>c.get(`${d}/gls/list`,{params:{gl_number:r},paramsSerializer:s=>u.stringify(s,{arrayFormat:"brackets"})}).then(s=>s.data)},I=n({glNo:e(),date:e(),size:e(),totalBundle:t(),totalPcs:g([e(),t()]),totalDefect:g([e(),t()]),lineNames:e(),totalColors:t()}),w=n({size:e(),totalPcs:t(),totalBundle:t()}),M=n({color:e(),totalPcs:t(),totalBundle:t(),totalSizes:t(),totalDefect:t().optional(),lineNames:e(),sizes:o(w)}),O=n({glNo:e(),sizes:o(w),colors:o(M)}),F=n({status:m(),message:e(),glNo:e(),hasRecentData:m(),startDate:e(),endDate:e(),count:t(),data:o(I),summary:O}),$=n({id:t(),cuttingGlColorId:t(),size:e(),orderQty:t(),cutQty:t(),stockOutQty:t(),replacementQty:t(),createdAt:e(),updatedAt:e(),sewingStockinQty:t(),sewingStockoutQty:t()}),q=n({id:t(),cuttingGlSummaryId:t(),color:e(),type:e(),orderQty:t(),cutQty:t(),stockOutQty:t(),replacementQty:t(),lastSyncAt:e(),createdAt:e(),updatedAt:e(),sewingTotalStockinQty:t(),sewingTotalStockoutQty:t(),sizes:o($)}),G=n({id:t(),glNumber:e(),orderQty:t(),cutQty:t(),stockOutQty:t(),replacementQty:t(),lastSyncAt:e(),sewingTotalStockinQty:t(),sewingTotalStockoutQty:t(),colors:o(q)}),U=n({status:m(),message:e(),data:G});G.omit({colors:!0});const K=b("gls",{state:()=>({data:[],searchResult:[],isSearching:!1,meta:{},links:{},loading:!1,error:null,currentPage:1,lastPage:1,search:"",summaryGl:[],summaryByColor:[],total:{},metaSummary:{},matrixData:[],matrixSummary:{}}),actions:{async fetch(r={}){this.loading=!0,this.error=null;try{const s={page:r.page??1,perPage:r.perPage??50,q:r.q??void 0,dateFrom:r.dateFrom,dateTo:r.dateTo};r.q&&(this.searchResult=[],this.isSearching=!0);const a=await c.get("/api/gls",{params:s}),l=k.parse(a.data);return this.meta=l.meta,this.links=l.links,this.currentPage=l.meta.currentPage,this.lastPage=l.meta.lastPage,r.q?this.searchResult=l.data:(this.data=l.data,this.isSearching=!1,this.searchResult=[]),i.parse({success:!0,message:l.message??"Gl Numbers loaded"})}catch(s){const a=s?.response?.data?.message||"Something went wrong";return this.error=a,i.parse({success:!1,message:a})}finally{this.loading=!1}},async fetchGLNumber(r){this.loading=!0,this.error=null;try{const a=(await c.get(`/api/gls/number/${r}`)).data;return i.parse({success:!0,message:a.message??"Gl Numbers loaded",id:a.data.id})}catch(s){const a=s?.response?.data?.message||"Something went wrong";return this.error=a,i.parse({success:!1,message:a})}finally{this.loading=!1}},async fetchSummaryGl(r){this.loading=!0,this.error=null;try{const s=await c.get("/api/gls/cutting-summary",{params:{glNumber:r}}),a=x.parse(s.data);return this.summaryGl=a.data.summaryByGl,this.summaryByColor=a.data.summaryByColor,this.metaSummary=a.data.metadata,this.total=a.data.grandTotal,i.parse({success:!0,message:s.data.message??"Gl Numbers loaded"})}catch(s){const a=s?.response?.data?.message||"Something went wrong";return this.error=a,i.parse({success:!1,message:a})}finally{this.loading=!1}},async fetchSyncCuttingGL(r){this.loading=!0,this.error=null;try{const s=await c.get("/api/gls/syncCuttingGlNumber",{params:{glNumber:r}}),a=U.parse(s.data);return console.log(a),i.parse({success:!0,message:s.data.message??"Gl Numbers loaded"})}catch(s){const a=s?.response?.data?.message||"Something went wrong";return this.error=a,i.parse({success:!1,message:a})}finally{this.loading=!1}},async fetchGLMatix(r){this.loading=!0,this.error=null;try{const s=await h.getMatrix(r),a=F.parse(s);return this.matrixData=a.data,this.matrixSummary=a.summary,i.parse({success:!0,message:a.message??"Summary Chart loaded",data:{startDate:a.startDate,endDate:a.endDate,glNo:a.glNo,summary:a.summary,chartData:a.data}})}catch(s){const a=s?.response?.data?.message||"Something went wrong";return this.error=a,i.parse({success:!1,message:a})}finally{this.loading=!1}},async fetchGLList(r){this.loading=!0,this.error=null;try{const s=await h.getList(r);return i.parse({success:!0,message:s.message??"GL Number List",data:s.data})}catch(s){const a=s?.response?.data?.message||"Something went wrong";return this.error=a,i.parse({success:!1,message:a})}finally{this.loading=!1}},async searchOrFetch(r){if(this.search!==r&&(this.searchResult=[],this.isSearching=!1),this.search=r,!r)return await this.fetch(),this.data;const s=this.data.filter(l=>l.glNumber?.toLowerCase().includes(r));return s.length>0?(this.searchResult=s,this.isSearching=!0,s):(await this.fetch({page:1,q:r})).success?this.searchResult:[]}},getters:{searchedItems:r=>{if(!r.search)return r.data;if(r.isSearching&&r.searchResult.length)return r.searchResult;const s=r.search.toLowerCase();return r.data.filter(a=>a.glNumber?.toLowerCase().includes(s))},options(){return this.searchedItems.map(r=>({value:r.glNumber||"",label:r.glNumber||""}))}}});export{J as G,U as a,K as u};
